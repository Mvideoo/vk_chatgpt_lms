{"ast":null,"code":"'use client';\n\nimport { useMemo, useState } from \"react\";\nimport { noop } from \"@vkontakte/vkjs\";\nimport { useStableCallback } from \"../../hooks/useStableCallback.js\";\nimport { useIsomorphicLayoutEffect } from \"../useIsomorphicLayoutEffect.js\";\nimport { BottomSheetController } from \"./controllers/BottomSheetController.js\";\nimport { CSSTransitionController } from \"./controllers/CSSTransitionController.js\";\n/**\n * # Checklist\n *\n * ## Возможности\n *\n * - [x] есть возможность открывать до определенного размера (см. `snapPoint`)\n * - [x] есть возможность закрыть при сильном смахивании вниз\n * - [x] есть возможность отключить взаимодействие на определённых элементах используя data-атрибут\n * - [x] есть возможность отключить взаимодействие на определённых элементах используя stopPropagation()\n *\n * ## Анимации\n *\n * - [x] оверлей становится светлее в зависимости от процента сворачивания\n *    - [x] при `snapPoint !== 'auto'` процент высчитывается относительно переданного `snapPoint.initial`\n * - [x] при перетаскивании за пределы есть анимация натяжения\n *   > note: в `ModalPage` этого эффекта нет при высоте 100% из-за `max-block-size: 100%`\n *\n * ## Пограничные кейсы\n *\n * - [x] ⚠️ не блокирует взаимодействие с _горизонтальным_ скроллом\n * - [x] ⚠️ не блокирует взаимодействие с _вертикальным_ скроллом\n * - [x] ⚠️ не блокирует взаимодействие с полями ввода\n * - [x] ⚠️ не блокирует взаимодействие с элементами вне корневого элемента\n *\n * @private\n */\nexport const useBottomSheet = (enabled, _ref) => {\n  let {\n    blocked,\n    snapPoint,\n    sheetCSSProperty,\n    backdropCSSProperty,\n    onSnapPointChange: onSnapPointChangeProp,\n    onDismiss: onDismissProp\n  } = _ref;\n  const [sheetScrollEl, setSheetScrollEl] = useState(null);\n  const [sheetEl, setSheetEl] = useState(null);\n  const [backdropEl, setBackdropEl] = useState(null);\n  const initialStyle = useMemo(() => enabled && snapPoint !== 'auto' ? {\n    [sheetCSSProperty]: `${snapPoint.initial}%`\n  } : undefined, [enabled, snapPoint, sheetCSSProperty]);\n  const onSnapPointChange = useStableCallback(onSnapPointChangeProp || noop);\n  const onDismiss = useStableCallback(onDismissProp || noop);\n  const bsController = useMemo(() => {\n    if (!enabled || sheetEl === null) {\n      return null;\n    }\n    return new BottomSheetController(sheetEl, {\n      sheetScrollEl: sheetScrollEl || null,\n      sheetTransitionController: new CSSTransitionController(sheetEl, sheetCSSProperty),\n      backdropTransitionController: backdropEl ? new CSSTransitionController(backdropEl, backdropCSSProperty) : null,\n      onSnapPointChange,\n      onDismiss\n    });\n  }, [enabled, sheetEl, sheetCSSProperty, sheetScrollEl, backdropEl, backdropCSSProperty, onSnapPointChange, onDismiss]);\n  const onPanStart = function onPanStart(event) {\n    if (!blocked) {\n      bsController.panStart(event.nativeEvent);\n    }\n  };\n  const onPanMove = function onPanMove(event) {\n    bsController.panMove(event.nativeEvent);\n  };\n  const onPanEnd = function onPanEnd() {\n    bsController.panEnd();\n  };\n  useIsomorphicLayoutEffect(function init() {\n    if (bsController) {\n      bsController.init(snapPoint);\n    }\n  }, [snapPoint, bsController]);\n  useIsomorphicLayoutEffect(() => function unmount() {\n    if (bsController) {\n      bsController.destroy();\n    }\n  }, [bsController]);\n  return [{\n    initialStyle,\n    setSheetEl,\n    setSheetScrollEl,\n    setBackdropEl\n  }, bsController !== null ? {\n    onTouchStart: onPanStart,\n    onTouchMove: onPanMove,\n    onTouchEnd: onPanEnd,\n    onTouchCancel: onPanEnd,\n    onMouseDown: onPanStart,\n    onMouseMove: onPanMove,\n    onMouseUp: onPanEnd,\n    onMouseLeave: onPanEnd\n  } : undefined];\n};","map":{"version":3,"names":["useMemo","useState","noop","useStableCallback","useIsomorphicLayoutEffect","BottomSheetController","CSSTransitionController","useBottomSheet","enabled","_ref","blocked","snapPoint","sheetCSSProperty","backdropCSSProperty","onSnapPointChange","onSnapPointChangeProp","onDismiss","onDismissProp","sheetScrollEl","setSheetScrollEl","sheetEl","setSheetEl","backdropEl","setBackdropEl","initialStyle","initial","undefined","bsController","sheetTransitionController","backdropTransitionController","onPanStart","event","panStart","nativeEvent","onPanMove","panMove","onPanEnd","panEnd","init","unmount","destroy","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel","onMouseDown","onMouseMove","onMouseUp","onMouseLeave"],"sources":["/Users/viktoriaromazanova/PycharmProjects/vk_chatgpt/frontend/node_modules/@vkontakte/vkui/src/lib/sheet/useBottomSheet.ts"],"sourcesContent":["'use client';\n\nimport {\n  type CSSProperties,\n  type Dispatch,\n  type SetStateAction,\n  type UIEvent,\n  type UIEventHandler,\n  useMemo,\n  useState,\n} from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { useStableCallback } from '../../hooks/useStableCallback';\nimport { useIsomorphicLayoutEffect } from '../useIsomorphicLayoutEffect';\nimport {\n  BottomSheetController,\n  type SnapPoint,\n  type SnapPointChange,\n} from './controllers/BottomSheetController';\nimport { CSSTransitionController } from './controllers/CSSTransitionController';\n\nexport type UseBottomSheetOptions = {\n  sheetCSSProperty: string;\n  backdropCSSProperty: string;\n  snapPoint: SnapPoint;\n  blocked?: boolean;\n  onSnapPointChange?: SnapPointChange;\n  onDismiss?: VoidFunction;\n};\n\nexport type UseBottomSheetHandlers = {\n  onTouchStart: UIEventHandler<HTMLElement>;\n  onTouchMove: UIEventHandler<HTMLElement>;\n  onTouchEnd: UIEventHandler<HTMLElement>;\n  onTouchCancel: UIEventHandler<HTMLElement>;\n  onMouseDown: UIEventHandler<HTMLElement>;\n  onMouseMove: UIEventHandler<HTMLElement>;\n  onMouseUp: UIEventHandler<HTMLElement>;\n  onMouseLeave: UIEventHandler<HTMLElement>;\n};\n\nexport type UseBottomSheetResult = [\n  {\n    initialStyle?: CSSProperties;\n    setSheetEl: Dispatch<SetStateAction<HTMLElement | null>>;\n    setSheetScrollEl: Dispatch<SetStateAction<HTMLElement | null>>;\n    setBackdropEl: Dispatch<SetStateAction<HTMLElement | null>>;\n  },\n  UseBottomSheetHandlers | undefined,\n];\n\n/**\n * # Checklist\n *\n * ## Возможности\n *\n * - [x] есть возможность открывать до определенного размера (см. `snapPoint`)\n * - [x] есть возможность закрыть при сильном смахивании вниз\n * - [x] есть возможность отключить взаимодействие на определённых элементах используя data-атрибут\n * - [x] есть возможность отключить взаимодействие на определённых элементах используя stopPropagation()\n *\n * ## Анимации\n *\n * - [x] оверлей становится светлее в зависимости от процента сворачивания\n *    - [x] при `snapPoint !== 'auto'` процент высчитывается относительно переданного `snapPoint.initial`\n * - [x] при перетаскивании за пределы есть анимация натяжения\n *   > note: в `ModalPage` этого эффекта нет при высоте 100% из-за `max-block-size: 100%`\n *\n * ## Пограничные кейсы\n *\n * - [x] ⚠️ не блокирует взаимодействие с _горизонтальным_ скроллом\n * - [x] ⚠️ не блокирует взаимодействие с _вертикальным_ скроллом\n * - [x] ⚠️ не блокирует взаимодействие с полями ввода\n * - [x] ⚠️ не блокирует взаимодействие с элементами вне корневого элемента\n *\n * @private\n */\nexport const useBottomSheet = (\n  enabled: boolean,\n  {\n    blocked,\n    snapPoint,\n    sheetCSSProperty,\n    backdropCSSProperty,\n    onSnapPointChange: onSnapPointChangeProp,\n    onDismiss: onDismissProp,\n  }: UseBottomSheetOptions,\n): UseBottomSheetResult => {\n  const [sheetScrollEl, setSheetScrollEl] = useState<HTMLElement | null>(null);\n  const [sheetEl, setSheetEl] = useState<HTMLElement | null>(null);\n  const [backdropEl, setBackdropEl] = useState<HTMLElement | null>(null);\n\n  const initialStyle = useMemo<CSSProperties | undefined>(\n    () =>\n      enabled && snapPoint !== 'auto' ? { [sheetCSSProperty]: `${snapPoint.initial}%` } : undefined,\n    [enabled, snapPoint, sheetCSSProperty],\n  );\n\n  const onSnapPointChange = useStableCallback(onSnapPointChangeProp || noop);\n  const onDismiss = useStableCallback(onDismissProp || noop);\n  const bsController = useMemo<BottomSheetController | null>(() => {\n    if (!enabled || sheetEl === null) {\n      return null;\n    }\n\n    return new BottomSheetController(sheetEl, {\n      sheetScrollEl: sheetScrollEl || null,\n      sheetTransitionController: new CSSTransitionController<string>(sheetEl, sheetCSSProperty),\n      backdropTransitionController: backdropEl\n        ? new CSSTransitionController(backdropEl, backdropCSSProperty)\n        : null,\n      onSnapPointChange,\n      onDismiss,\n    });\n  }, [\n    enabled,\n    sheetEl,\n    sheetCSSProperty,\n    sheetScrollEl,\n    backdropEl,\n    backdropCSSProperty,\n    onSnapPointChange,\n    onDismiss,\n  ]);\n\n  const onPanStart = function onPanStart(event: UIEvent<HTMLElement>) {\n    if (!blocked) {\n      bsController!.panStart(event.nativeEvent);\n    }\n  };\n\n  const onPanMove = function onPanMove(event: UIEvent<HTMLElement>) {\n    bsController!.panMove(event.nativeEvent);\n  };\n\n  const onPanEnd = function onPanEnd() {\n    bsController!.panEnd();\n  };\n\n  useIsomorphicLayoutEffect(\n    function init() {\n      if (bsController) {\n        bsController.init(snapPoint);\n      }\n    },\n    [snapPoint, bsController],\n  );\n\n  useIsomorphicLayoutEffect(\n    () =>\n      function unmount() {\n        if (bsController) {\n          bsController.destroy();\n        }\n      },\n    [bsController],\n  );\n\n  return [\n    {\n      initialStyle,\n      setSheetEl,\n      setSheetScrollEl,\n      setBackdropEl,\n    },\n    bsController !== null\n      ? {\n          onTouchStart: onPanStart,\n          onTouchMove: onPanMove,\n          onTouchEnd: onPanEnd,\n          onTouchCancel: onPanEnd,\n          onMouseDown: onPanStart,\n          onMouseMove: onPanMove,\n          onMouseUp: onPanEnd,\n          onMouseLeave: onPanEnd,\n        }\n      : undefined,\n  ];\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}