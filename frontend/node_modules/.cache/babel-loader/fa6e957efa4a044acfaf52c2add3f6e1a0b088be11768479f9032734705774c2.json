{"ast":null,"code":"import * as React from \"react\";\nimport { pressedKey } from \"../lib/accessibility.js\";\nimport { useDOM } from \"../lib/dom.js\";\nimport { useGlobalEventListener } from \"./useGlobalEventListener.js\";\nexport function useTabsNavigation() {\n  let enabled = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n  let isRtl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  const {\n    document\n  } = useDOM();\n  const tabsRef = React.useRef(null);\n  const getTabEls = () => {\n    if (!tabsRef.current) {\n      return [];\n    }\n    return Array.from(\n    // eslint-disable-next-line no-restricted-properties\n    tabsRef.current.querySelectorAll(`[role=tab]:not([disabled]):not([aria-disabled='true'])`));\n  };\n  const handleDocumentKeydown = event => {\n    if (!document || !tabsRef.current || !enabled) {\n      return;\n    }\n    const key = pressedKey(event);\n    switch (key) {\n      case 'ArrowLeft':\n      case 'ArrowRight':\n      case 'End':\n      case 'Home':\n        {\n          const tabEls = getTabEls();\n          const currentFocusedElIndex = tabEls.findIndex(el => document.activeElement === el);\n          if (currentFocusedElIndex === -1) {\n            return;\n          }\n          let nextIndex = 0;\n          if (key === 'Home') {\n            nextIndex = 0;\n          } else if (key === 'End') {\n            nextIndex = tabEls.length - 1;\n          } else {\n            const offset = (key === 'ArrowRight' ? 1 : -1) * (isRtl ? -1 : 1);\n            nextIndex = currentFocusedElIndex + offset;\n          }\n          const nextTabEl = tabEls[nextIndex];\n          if (nextTabEl) {\n            event.preventDefault();\n            nextTabEl.focus();\n          }\n          break;\n        }\n      /*\n      В JAWS и NVDA стрелка вниз активирует контент.\n      Это не прописано в стандартах, но по ссылке ниже это рекомендуется делать.\n      https://inclusive-components.design/tabbed-interfaces/\n      */\n      case 'ArrowDown':\n        {\n          const tabEls = getTabEls();\n          const currentFocusedEl = tabEls.find(el => document.activeElement === el);\n          if (!currentFocusedEl || currentFocusedEl.getAttribute('aria-selected') !== 'true') {\n            return;\n          }\n          const relatedContentElId = currentFocusedEl.getAttribute('aria-controls');\n          if (!relatedContentElId) {\n            return;\n          }\n          // eslint-disable-next-line no-restricted-properties\n          const relatedContentEl = document.getElementById(relatedContentElId);\n          if (!relatedContentEl) {\n            return;\n          }\n          event.preventDefault();\n          relatedContentEl.focus();\n          break;\n        }\n      case 'Space':\n      case 'Enter':\n        {\n          const tabEls = getTabEls();\n          const currentFocusedEl = tabEls.find(el => document.activeElement === el);\n          if (currentFocusedEl) {\n            currentFocusedEl.click();\n          }\n        }\n    }\n  };\n  useGlobalEventListener(document, 'keydown', handleDocumentKeydown, {\n    capture: true\n  });\n  return {\n    tabsRef\n  };\n}","map":{"version":3,"names":["React","pressedKey","useDOM","useGlobalEventListener","useTabsNavigation","enabled","arguments","length","undefined","isRtl","document","tabsRef","useRef","getTabEls","current","Array","from","querySelectorAll","handleDocumentKeydown","event","key","tabEls","currentFocusedElIndex","findIndex","el","activeElement","nextIndex","offset","nextTabEl","preventDefault","focus","currentFocusedEl","find","getAttribute","relatedContentElId","relatedContentEl","getElementById","click","capture"],"sources":["/Users/viktoriaromazanova/PycharmProjects/vk_chatgpt/frontend/node_modules/@vkontakte/vkui/src/hooks/useTabsNavigation.ts"],"sourcesContent":["import * as React from 'react';\nimport { pressedKey } from '../lib/accessibility';\nimport { useDOM } from '../lib/dom';\nimport { useGlobalEventListener } from './useGlobalEventListener';\n\nexport function useTabsNavigation(enabled = true, isRtl = false) {\n  const { document } = useDOM();\n  const tabsRef = React.useRef<HTMLDivElement>(null);\n  const getTabEls = () => {\n    if (!tabsRef.current) {\n      return [];\n    }\n\n    return Array.from(\n      // eslint-disable-next-line no-restricted-properties\n      tabsRef.current.querySelectorAll<HTMLDivElement>(\n        `[role=tab]:not([disabled]):not([aria-disabled='true'])`,\n      ),\n    );\n  };\n\n  const handleDocumentKeydown = (event: KeyboardEvent) => {\n    if (!document || !tabsRef.current || !enabled) {\n      return;\n    }\n\n    const key = pressedKey(event);\n\n    switch (key) {\n      case 'ArrowLeft':\n      case 'ArrowRight':\n      case 'End':\n      case 'Home': {\n        const tabEls = getTabEls();\n        const currentFocusedElIndex = tabEls.findIndex((el) => document.activeElement === el);\n        if (currentFocusedElIndex === -1) {\n          return;\n        }\n\n        let nextIndex = 0;\n        if (key === 'Home') {\n          nextIndex = 0;\n        } else if (key === 'End') {\n          nextIndex = tabEls.length - 1;\n        } else {\n          const offset = (key === 'ArrowRight' ? 1 : -1) * (isRtl ? -1 : 1);\n          nextIndex = currentFocusedElIndex + offset;\n        }\n\n        const nextTabEl = tabEls[nextIndex];\n\n        if (nextTabEl) {\n          event.preventDefault();\n          nextTabEl.focus();\n        }\n\n        break;\n      }\n      /*\n       В JAWS и NVDA стрелка вниз активирует контент.\n       Это не прописано в стандартах, но по ссылке ниже это рекомендуется делать.\n       https://inclusive-components.design/tabbed-interfaces/\n      */\n      case 'ArrowDown': {\n        const tabEls = getTabEls();\n        const currentFocusedEl = tabEls.find((el) => document.activeElement === el);\n\n        if (!currentFocusedEl || currentFocusedEl.getAttribute('aria-selected') !== 'true') {\n          return;\n        }\n\n        const relatedContentElId = currentFocusedEl.getAttribute('aria-controls');\n        if (!relatedContentElId) {\n          return;\n        }\n\n        // eslint-disable-next-line no-restricted-properties\n        const relatedContentEl = document.getElementById(relatedContentElId);\n        if (!relatedContentEl) {\n          return;\n        }\n\n        event.preventDefault();\n        relatedContentEl.focus();\n\n        break;\n      }\n      case 'Space':\n      case 'Enter': {\n        const tabEls = getTabEls();\n        const currentFocusedEl = tabEls.find((el) => document.activeElement === el);\n        if (currentFocusedEl) {\n          currentFocusedEl.click();\n        }\n      }\n    }\n  };\n\n  useGlobalEventListener(document, 'keydown', handleDocumentKeydown, {\n    capture: true,\n  });\n\n  return {\n    tabsRef,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}