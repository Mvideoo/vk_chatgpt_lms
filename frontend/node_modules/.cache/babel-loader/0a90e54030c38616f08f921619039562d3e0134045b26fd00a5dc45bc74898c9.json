{"ast":null,"code":"import bridge from\"@vkontakte/vk-bridge\";import{AdaptivityProvider,AppRoot,Button,ConfigProvider,Div,Panel,SplitCol,SplitLayout,Textarea,View}from\"@vkontakte/vkui\";import\"@vkontakte/vkui/dist/vkui.css\";import{AnimatePresence,motion}from\"framer-motion\";import React,{useEffect,useRef,useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const questions=[\"Расскажи о своей текущей работе. Чем ты занимаешься и какие задачи решаешь? Какие навыки и профессиональные компетенции наиболее важны в твоей сфере?\",\"Любишь ли ты точность и технические детали, или тебе ближе творчество и воображение?\",\"Что тебя по-настоящему вдохновляет? Есть ли хобби или занятия, которые заряжают тебя энергией?\",\"Ты больше чувствуешь себя творческим человеком (креатив, искусство, нестандартные идеи) или техническим (логика, системы, точные решения)?\",\" Если бы от твоего выбора прямо сейчас зависела жизнь другого человека — но с риском для себя — как думаешь, что бы ты сделал?\",\" Есть ли у тебя тяга к заботе о здоровье — своём и окружающих — или тебя больше влечёт работа руками, с механизмами и конструкциями?\"];const App=()=>{const[activePanel,setActivePanel]=useState(\"intro\");const[currentQuestionIndex,setCurrentQuestionIndex]=useState(0);const[messages,setMessages]=useState([]);const[answers,setAnswers]=useState([]);const[input,setInput]=useState(\"\");const[loading,setLoading]=useState(false);const[finished,setFinished]=useState(false);const[characterImage,setCharacterImage]=useState(null);const[characterImageBase64,setCharacterImageBase64]=useState(null);const[fontsLoaded,setFontsLoaded]=useState(false);const messagesEndRef=useRef(null);const[showPinnedMessage,setShowPinnedMessage]=useState(true);// Минимальное время ожидания экрана загрузки (в мс)\nconst MIN_LOADING_TIME=4500;const[loadingStartTime]=useState(Date.now());// Ожидание загрузки всех шрифтов с учетом минимальной задержки\nuseEffect(()=>{document.fonts.ready.then(()=>{const elapsed=Date.now()-loadingStartTime;const delay=Math.max(0,MIN_LOADING_TIME-elapsed);setTimeout(()=>setFontsLoaded(true),delay);});},[loadingStartTime]);// Определяем, поддерживает ли устройство сенсорный ввод (для автоскролла)\nconst isTouchDevice=\"ontouchstart\"in window||navigator.maxTouchPoints>0;const[viewportHeight,setViewportHeight]=useState(window.innerHeight);useEffect(()=>{const handleResize=()=>{setViewportHeight(window.innerHeight);};window.addEventListener(\"resize\",handleResize);return()=>window.removeEventListener(\"resize\",handleResize);},[]);// Эффект для автоскролла в конец чата (только для сенсорных устройств)\nuseEffect(()=>{if(isTouchDevice&&messagesEndRef.current){messagesEndRef.current.scrollIntoView({behavior:\"smooth\",block:\"end\"});}},[messages,isTouchDevice,viewportHeight]);useEffect(()=>{if(activePanel===\"chat\"&&messages.length===0){setMessages([{text:questions[0],from:\"gpt\",key:Date.now()}]);}},[activePanel,messages.length]);const sendAnswer=async()=>{if(!input.trim())return;const answerText=input.trim();const questionText=questions[currentQuestionIndex];const userMessage={text:answerText,from:\"user\",key:Date.now()};const updatedAnswers=[...answers,{question:questionText,answer:answerText}];setMessages(prev=>[...prev,userMessage]);setAnswers(updatedAnswers);setInput(\"\");setLoading(true);const nextIndex=currentQuestionIndex+1;if(nextIndex<questions.length){setTimeout(()=>{const nextMessage={text:questions[nextIndex],from:\"gpt\",key:Date.now()};setMessages(prev=>[...prev,nextMessage]);setCurrentQuestionIndex(nextIndex);setLoading(false);},700);}else{setFinished(true);try{setMessages(prev=>[...prev,{text:\"Ai проанализировал твои ответы и твоя история очень похожа на.....\",from:\"gpt\",key:Date.now()}]);const res=await fetch(\"https://xn-----dlccdmca1acd3bode5aey.xn--p1ai:8000/chat/send\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({user_id:\"asnkansd\",username:\"user1\",answers:updatedAnswers})});if(!res.ok)throw new Error(\"Image response failed\");const blob=await res.blob();const reader=new FileReader();reader.onloadend=()=>{// reader.result === 'data:image/png;base64,AAA...'\nconst dataUrl=reader.result;setCharacterImage(dataUrl);// при необходимости можно взять только часть после запятой:\nsetCharacterImageBase64(dataUrl.split(\",\")[1]);};reader.readAsDataURL(blob);}catch(error){setMessages(prev=>[...prev,{text:\"Хм... Попробуйте еще раз!\",from:\"gpt\",key:Date.now()}]);}setLoading(false);}};const renderMessages=()=>/*#__PURE__*/_jsxs(Div,{children:[/*#__PURE__*/_jsx(AnimatePresence,{initial:false,children:messages.map(msg=>/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:0.3},style:{display:\"flex\",justifyContent:msg.from===\"user\"?\"flex-end\":\"flex-start\",marginBottom:10},children:/*#__PURE__*/_jsx(\"div\",{style:{background:msg.from===\"user\"?\"#f0e8dd\":\"#e3d5c4\",color:\"#1c1c1c\",padding:\"10px 14px\",borderRadius:\"16px\",display:\"inline-block\",maxWidth:\"75%\",wordBreak:\"break-word\"},children:msg.text})},msg.key))}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]});// Отображаем экран загрузки, пока не загружены все шрифты\nif(!fontsLoaded){return/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:0,left:0,width:\"100vw\",height:\"100vh\",backgroundColor:\"#FDF7F0\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",zIndex:9999},children:/*#__PURE__*/_jsx(\"div\",{className:\"loader\"})});}return/*#__PURE__*/_jsx(ConfigProvider,{children:/*#__PURE__*/_jsx(AdaptivityProvider,{children:/*#__PURE__*/_jsx(\"div\",{className:\"theme\",style:{width:\"100%\",height:\"100%\",overflow:\"hidden\",backgroundColor:\"#FDF7F0\"},children:/*#__PURE__*/_jsx(AppRoot,{children:/*#__PURE__*/_jsx(SplitLayout,{style:{width:\"100%\",height:\"100%\"},children:/*#__PURE__*/_jsx(SplitCol,{style:{width:\"100%\",height:\"100%\"},children:/*#__PURE__*/_jsxs(View,{activePanel:activePanel,children:[/*#__PURE__*/_jsx(Panel,{id:\"intro\",children:/*#__PURE__*/_jsxs(Div,{style:{display:\"flex\",flexDirection:\"column\",justifyContent:\"space-between\",minHeight:\"100vh\",backgroundColor:\"#fdf7f0\",padding:0},children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\"},children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://i.pinimg.com/736x/01/90/d6/0190d61dbacf5e04320ca41c47da3d6c.jpg\",alt:\"\\u0412\\u0434\\u043E\\u0445\\u043D\\u043E\\u0432\\u0438\\u0442\\u0435\\u043B\\u0438\",style:{width:\"100%\",objectFit:\"cover\",maxHeight:\"200px\"}}),/*#__PURE__*/_jsxs(\"div\",{style:{position:\"absolute\",top:\"20%\",left:\"10%\",color:\"#254E2E\",font:\"Anticva\",fontSize:\"20px\",fontWeight:\"bold\"},children:[\"\\u0411\\u041B\\u0410\\u0413\\u041E \\u041E\\u0411\\u0429\\u0415\\u0415 \",/*#__PURE__*/_jsx(\"br\",{}),\" \\u0412\\u042B\\u0428\\u0415 \\u041C\\u041E\\u0415\\u0413\\u041E\"]})]}),/*#__PURE__*/_jsxs(Div,{style:{padding:\"20px\",background:\"#ffffff\",borderRadius:\"12px\",boxShadow:\"0px 6px 12px rgba(0, 0, 0, 0.1)\"},children:[/*#__PURE__*/_jsxs(\"p\",{style:{color:\"#6C828D\",font:\"montserrat\",lineHeight:\"1.6\"},children:[\"\\u0414\\u043E\\u0431\\u0440\\u043E \\u043F\\u043E\\u0436\\u0430\\u043B\\u043E\\u0432\\u0430\\u0442\\u044C \\u0432 \\u043F\\u0440\\u0438\\u043B\\u043E\\u0436\\u0435\\u043D\\u0438\\u0435\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:\"\\xAB\\u041A\\u0442\\u043E \\u0442\\u044B \\u0438\\u0437 \\u0433\\u0435\\u0440\\u043E\\u0435\\u0432 \\u043F\\u0440\\u043E\\u0448\\u043B\\u043E\\u0433\\u043E?\\xBB\"}),\" \\u2014 \\u0447\\u0430\\u0441\\u0442\\u044C \\u043F\\u0440\\u043E\\u0435\\u043A\\u0442\\u0430 \",/*#__PURE__*/_jsx(\"strong\",{children:\"\\xAB\\u0412\\u0434\\u043E\\u0445\\u043D\\u043E\\u0432\\u0438\\u0442\\u0435\\u043B\\u0438\\xBB\"}),\".\"]}),/*#__PURE__*/_jsx(\"p\",{style:{color:\"#6C828D\",font:\"montserrat\",lineHeight:\"1.6\"},children:\"\\u042D\\u0442\\u043E\\u0442 \\u0441\\u0435\\u0440\\u0432\\u0438\\u0441 \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D, \\u0447\\u0442\\u043E\\u0431\\u044B \\u043A\\u0430\\u0436\\u0434\\u044B\\u0439 \\u043C\\u043E\\u0433 \\u043F\\u043E\\u0447\\u0443\\u0432\\u0441\\u0442\\u0432\\u043E\\u0432\\u0430\\u0442\\u044C \\u043B\\u0438\\u0447\\u043D\\u0443\\u044E \\u0441\\u0432\\u044F\\u0437\\u044C \\u0441 \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u0435\\u0439 \\u0412\\u0435\\u043B\\u0438\\u043A\\u043E\\u0439 \\u041E\\u0442\\u0435\\u0447\\u0435\\u0441\\u0442\\u0432\\u0435\\u043D\\u043D\\u043E\\u0439 \\u0432\\u043E\\u0439\\u043D\\u044B.\"}),/*#__PURE__*/_jsxs(\"p\",{style:{color:\"#6C828D\",font:\"CodeNext\",lineHeight:\"1.6\"},children:[\"\\u041E\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439 \\u043D\\u0430 \\u0432\\u043E\\u043F\\u0440\\u043E\\u0441\\u044B, \\u0440\\u0430\\u0441\\u0441\\u043A\\u0430\\u0437\\u044B\\u0432\\u0430\\u044F \\u043E \\u0441\\u0435\\u0431\\u0435 \\u2014 \\u0441\\u0432\\u043E\\u0431\\u043E\\u0434\\u043D\\u043E \\u0438 \\u0438\\u0441\\u043A\\u0440\\u0435\\u043D\\u043D\\u0435.\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u041F\\u043E\\u0441\\u043B\\u0435 \\u044D\\u0442\\u043E\\u0433\\u043E \\u0442\\u044B \\u0443\\u0437\\u043D\\u0430\\u0435\\u0448\\u044C, \\u043D\\u0430 \\u043A\\u043E\\u0433\\u043E \\u0438\\u0437 \\u0433\\u0435\\u0440\\u043E\\u0435\\u0432 \\u043F\\u0440\\u043E\\u0448\\u043B\\u043E\\u0433\\u043E \\u0442\\u044B \\u043F\\u043E\\u0445\\u043E\\u0436.\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u0418 \\u0441\\u043C\\u043E\\u0436\\u0435\\u0448\\u044C \\u043F\\u043E\\u0434\\u0435\\u043B\\u0438\\u0442\\u044C\\u0441\\u044F \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u043E\\u043C \\u0432 \\u0441\\u043E\\u0446\\u0441\\u0435\\u0442\\u044F\\u0445.\"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{position:\"sticky\",bottom:0,backgroundColor:\"#f0e8dd\",padding:\"12px 16px\",zIndex:10},children:/*#__PURE__*/_jsx(Button,{size:\"l\",stretched:true,style:{marginTop:8,backgroundColor:\"#30663d\",color:\"#b6d3b6\"},onClick:()=>setActivePanel(\"chat\"),children:\"\\u041D\\u0430\\u0447\\u0430\\u0442\\u044C\"})})]})}),/*#__PURE__*/_jsxs(Panel,{id:\"chat\",children:[showPinnedMessage&&/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:\"#e0d6c8\",// чуть темнее фона чата\npadding:\"10px 14px\",display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",borderBottom:\"1px solid #ccc\",position:\"relative\",zIndex:19// чуть ниже шапки\n},children:[/*#__PURE__*/_jsx(\"div\",{style:{color:\"#1c1c1c\",fontSize:\"14px\",flex:1},children:\"\\u26A0\\uFE0F \\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043E\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u0447\\u0435\\u0441\\u0442\\u043D\\u043E \\u2014 \\u044D\\u0442\\u043E \\u043F\\u043E\\u043C\\u043E\\u0436\\u0435\\u0442 \\u043F\\u043E\\u0434\\u043E\\u0431\\u0440\\u0430\\u0442\\u044C \\u0433\\u0435\\u0440\\u043E\\u044F \\u0442\\u043E\\u0447\\u043D\\u0435\\u0435.\"}),/*#__PURE__*/_jsx(\"div\",{onClick:()=>setShowPinnedMessage(false),style:{marginLeft:\"12px\",cursor:\"pointer\",fontSize:\"18px\",color:\"#888\",lineHeight:\"1\"},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",height:\"100vh\",position:\"relative\",background:\"#FDF7F0\",overflow:\"hidden\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:\"#f0e8dd\",padding:\"12px 16px\",borderBottom:\"1px solid #aaa\",display:\"flex\",alignItems:\"center\",position:\"fixed\",top:0,left:0,right:0,zIndex:20},children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://i.pinimg.com/736x/01/90/d6/0190d61dbacf5e04320ca41c47da3d6c.jpg\",alt:\"\\u0422\\u0432\\u043E\\u0439 \\u0433\\u0435\\u0440\\u043E\\u0439 \\u043F\\u043E\\u0431\\u0435\\u0434\\u044B\",style:{width:40,height:40,borderRadius:\"50%\",objectFit:\"cover\",marginRight:12}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:\"bold\",fontSize:16,color:\"#254E2E\"},children:\"\\u0422\\u0432\\u043E\\u0439 \\u0433\\u0435\\u0440\\u043E\\u0439 \\u043F\\u043E\\u0431\\u0435\\u0434\\u044B\"}),loading&&/*#__PURE__*/_jsx(\"div\",{style:{fontSize:12,color:\"#1c1c1c\"},children:\"\\u043F\\u0435\\u0447\\u0430\\u0442\\u0430\\u0435\\u0442...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:\"1 1 auto\",overflowY:\"auto\",padding:\"16px\",marginTop:showPinnedMessage?120:65},children:[renderMessages(),characterImage&&/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,scale:0.9},animate:{opacity:1,scale:1},transition:{duration:0.5},children:/*#__PURE__*/_jsx(Div,{children:/*#__PURE__*/_jsx(\"img\",{src:characterImage,alt:\"Character\",style:{maxWidth:\"100%\",height:\"auto\",borderRadius:\"8px\",marginTop:\"20px\",maxHeight:\"400px\"}})})})]}),!finished?/*#__PURE__*/_jsxs(\"div\",{style:{position:\"sticky\",bottom:0,backgroundColor:\"#f0e8dd\",padding:\"12px 16px\",zIndex:10},children:[/*#__PURE__*/_jsx(Textarea,{value:input,onChange:e=>setInput(e.target.value),onKeyDown:e=>{if(e.key===\"Enter\"&&!e.shiftKey){e.preventDefault();sendAnswer();}},placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043E\\u0442\\u0432\\u0435\\u0442...\",style:{backgroundColor:\"rgba(84,129,84,0.76)\",color:\"#1c1c1c\",borderRadius:\"12px\",padding:\"10px\",fontSize:\"16px\",resize:\"none\"}}),/*#__PURE__*/_jsx(Button,{size:\"l\",stretched:true,style:{marginTop:8,backgroundColor:\"#30663d\",color:\"#b6d3b6\"},onClick:sendAnswer,loading:loading,children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]}):characterImage?/*#__PURE__*/_jsxs(Div,{style:{padding:\"16px\",display:\"flex\",flexDirection:\"column\",gap:\"12px\",backgroundColor:\"#fdf7f0\",borderTop:\"1px solid #ddd\"},children:[/*#__PURE__*/_jsx(Button,{size:\"l\",stretched:true,style:{backgroundColor:\"#30663d\",color:\"#ffffff\"},onClick:async()=>{if(!characterImage)return;try{await bridge.send(\"VKWebAppShowStoryBox\",{background_type:\"image\",blob:characterImage,attachment:{text:'open',type:'url',url:\"https://vk.com/app53519220\"}});const res=await fetch(\"https://xn-----dlccdmca1acd3bode5aey.xn--p1ai:8000/edit_stat\",{method:\"POST\"});}catch(err){console.error(\"Ошибка шэринга:\",err);}},children:\"\\u0420\\u0430\\u0441\\u0441\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u043E \\u043C\\u043E\\u0435\\u043C \\u0433\\u0435\\u0440\\u043E\\u0435 \\u0432 \\u0412\\u041A \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F\\u0445\"}),/*#__PURE__*/_jsx(Button,{size:\"l\",stretched:true,style:{backgroundColor:\"#30663d\",color:\"#ffffff\"},href:\"https://xn--b1aaffobumib0c5a.xn--p1ai/\",target:\"_blank\",children:\"\\u0423\\u0437\\u043D\\u0430\\u0442\\u044C \\u0431\\u043E\\u043B\\u044C\\u0448\\u0435 \\u043E \\u0434\\u0432\\u0438\\u0436\\u0435\\u043D\\u0438\\u0438 \\u0412\\u0434\\u043E\\u0445\\u043D\\u043E\\u0432\\u0438\\u0442\\u0435\\u043B\\u0438\"}),/*#__PURE__*/_jsx(Button,{size:\"l\",stretched:true,style:{backgroundColor:\"#30663d\",color:\"#ffffff\"},href:\"https://xn----dtbbicare8alexe.xn--p1ai/\",target:\"_blank\",children:\"\\u0423\\u0437\\u043D\\u0430\\u0442\\u044C \\u0438\\u0441\\u0442\\u043E\\u0440\\u0438\\u0438 \\u0434\\u0440\\u0443\\u0433\\u0438\\u0445 \\u0433\\u0435\\u0440\\u043E\\u0435\\u0432\"})]}):null]})]})]})})})})})})});};export default App;","map":{"version":3,"names":["bridge","AdaptivityProvider","AppRoot","Button","ConfigProvider","Div","Panel","SplitCol","SplitLayout","Textarea","View","AnimatePresence","motion","React","useEffect","useRef","useState","jsx","_jsx","jsxs","_jsxs","questions","App","activePanel","setActivePanel","currentQuestionIndex","setCurrentQuestionIndex","messages","setMessages","answers","setAnswers","input","setInput","loading","setLoading","finished","setFinished","characterImage","setCharacterImage","characterImageBase64","setCharacterImageBase64","fontsLoaded","setFontsLoaded","messagesEndRef","showPinnedMessage","setShowPinnedMessage","MIN_LOADING_TIME","loadingStartTime","Date","now","document","fonts","ready","then","elapsed","delay","Math","max","setTimeout","isTouchDevice","window","navigator","maxTouchPoints","viewportHeight","setViewportHeight","innerHeight","handleResize","addEventListener","removeEventListener","current","scrollIntoView","behavior","block","length","text","from","key","sendAnswer","trim","answerText","questionText","userMessage","updatedAnswers","question","answer","prev","nextIndex","nextMessage","res","fetch","method","headers","body","JSON","stringify","user_id","username","ok","Error","blob","reader","FileReader","onloadend","dataUrl","result","split","readAsDataURL","error","renderMessages","children","initial","map","msg","div","opacity","y","animate","exit","transition","duration","style","display","justifyContent","marginBottom","background","color","padding","borderRadius","maxWidth","wordBreak","ref","position","top","left","width","height","backgroundColor","alignItems","zIndex","className","overflow","id","flexDirection","minHeight","src","alt","objectFit","maxHeight","font","fontSize","fontWeight","boxShadow","lineHeight","bottom","size","stretched","marginTop","onClick","borderBottom","flex","marginLeft","cursor","right","marginRight","overflowY","scale","value","onChange","e","target","onKeyDown","shiftKey","preventDefault","placeholder","resize","gap","borderTop","send","background_type","attachment","type","url","err","console","href"],"sources":["/Users/viktoriaromazanova/PycharmProjects/vk_chatgpt/frontend/src/App.js"],"sourcesContent":["import bridge from \"@vkontakte/vk-bridge\";\nimport {\n    AdaptivityProvider,\n    AppRoot,\n    Button,\n    ConfigProvider,\n    Div,\n    Panel,\n    SplitCol,\n    SplitLayout,\n    Textarea,\n    View,\n} from \"@vkontakte/vkui\";\nimport \"@vkontakte/vkui/dist/vkui.css\";\nimport {AnimatePresence, motion} from \"framer-motion\";\nimport React, {useEffect, useRef, useState} from \"react\";\n\nconst questions = [\n    \"Расскажи о своей текущей работе. Чем ты занимаешься и какие задачи решаешь? Какие навыки и профессиональные компетенции наиболее важны в твоей сфере?\",\n    \"Любишь ли ты точность и технические детали, или тебе ближе творчество и воображение?\",\n    \"Что тебя по-настоящему вдохновляет? Есть ли хобби или занятия, которые заряжают тебя энергией?\",\n    \"Ты больше чувствуешь себя творческим человеком (креатив, искусство, нестандартные идеи) или техническим (логика, системы, точные решения)?\",\n    \" Если бы от твоего выбора прямо сейчас зависела жизнь другого человека — но с риском для себя — как думаешь, что бы ты сделал?\",\n    \" Есть ли у тебя тяга к заботе о здоровье — своём и окружающих — или тебя больше влечёт работа руками, с механизмами и конструкциями?\",\n];\n\nconst App = () => {\n    const [activePanel, setActivePanel] = useState(\"intro\");\n    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n    const [messages, setMessages] = useState([]);\n    const [answers, setAnswers] = useState([]);\n    const [input, setInput] = useState(\"\");\n    const [loading, setLoading] = useState(false);\n    const [finished, setFinished] = useState(false);\n    const [characterImage, setCharacterImage] = useState(null);\n    const [characterImageBase64, setCharacterImageBase64] = useState(null);\n    const [fontsLoaded, setFontsLoaded] = useState(false);\n    const messagesEndRef = useRef(null);\n    const [showPinnedMessage, setShowPinnedMessage] = useState(true);\n\n\n    // Минимальное время ожидания экрана загрузки (в мс)\n    const MIN_LOADING_TIME = 4500;\n    const [loadingStartTime] = useState(Date.now());\n\n    // Ожидание загрузки всех шрифтов с учетом минимальной задержки\n    useEffect(() => {\n        document.fonts.ready.then(() => {\n            const elapsed = Date.now() - loadingStartTime;\n            const delay = Math.max(0, MIN_LOADING_TIME - elapsed);\n            setTimeout(() => setFontsLoaded(true), delay);\n        });\n    }, [loadingStartTime]);\n\n    // Определяем, поддерживает ли устройство сенсорный ввод (для автоскролла)\n    const isTouchDevice =\n        \"ontouchstart\" in window || navigator.maxTouchPoints > 0;\n    const [viewportHeight, setViewportHeight] = useState(window.innerHeight);\n\n    useEffect(() => {\n        const handleResize = () => {\n            setViewportHeight(window.innerHeight);\n        };\n\n        window.addEventListener(\"resize\", handleResize);\n        return () => window.removeEventListener(\"resize\", handleResize);\n    }, []);\n\n    // Эффект для автоскролла в конец чата (только для сенсорных устройств)\n    useEffect(() => {\n        if (isTouchDevice && messagesEndRef.current) {\n            messagesEndRef.current.scrollIntoView({\n                behavior: \"smooth\",\n                block: \"end\",\n            });\n        }\n    }, [messages, isTouchDevice, viewportHeight]);\n\n    useEffect(() => {\n        if (activePanel === \"chat\" && messages.length === 0) {\n            setMessages([{text: questions[0], from: \"gpt\", key: Date.now()}]);\n        }\n    }, [activePanel, messages.length]);\n\n    const sendAnswer = async () => {\n        if (!input.trim()) return;\n\n        const answerText = input.trim();\n        const questionText = questions[currentQuestionIndex];\n\n        const userMessage = {text: answerText, from: \"user\", key: Date.now()};\n        const updatedAnswers = [\n            ...answers,\n            {question: questionText, answer: answerText},\n        ];\n\n        setMessages((prev) => [...prev, userMessage]);\n        setAnswers(updatedAnswers);\n        setInput(\"\");\n        setLoading(true);\n        const nextIndex = currentQuestionIndex + 1;\n\n\n        if (nextIndex < questions.length) {\n            setTimeout(() => {\n                const nextMessage = {\n                    text: questions[nextIndex],\n                    from: \"gpt\",\n                    key: Date.now(),\n                };\n                setMessages((prev) => [...prev, nextMessage]);\n                setCurrentQuestionIndex(nextIndex);\n                setLoading(false);\n            }, 700);\n        } else {\n            setFinished(true);\n            try {\n                setMessages((prev) => [\n                    ...prev,\n                    {\n                        text: \"Ai проанализировал твои ответы и твоя история очень похожа на.....\",\n                        from: \"gpt\",\n                        key: Date.now(),\n                    },\n                ]);\n                const res = await fetch(\n                    \"https://xn-----dlccdmca1acd3bode5aey.xn--p1ai:8000/chat/send\",\n                    {\n                        method: \"POST\",\n                        headers: {\"Content-Type\": \"application/json\"},\n                        body: JSON.stringify({\n                            user_id: \"asnkansd\",\n                            username: \"user1\",\n                            answers: updatedAnswers,\n                        }),\n                    }\n                );\n\n                if (!res.ok) throw new Error(\"Image response failed\");\n                const blob = await res.blob();\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    // reader.result === 'data:image/png;base64,AAA...'\n                    const dataUrl = reader.result;\n                    setCharacterImage(dataUrl);\n                    // при необходимости можно взять только часть после запятой:\n                    setCharacterImageBase64(dataUrl.split(\",\")[1]);\n                };\n                reader.readAsDataURL(blob);\n            } catch (error) {\n                setMessages((prev) => [\n                    ...prev,\n                    {text: \"Хм... Попробуйте еще раз!\", from: \"gpt\", key: Date.now()},\n                ]);\n            }\n\n            setLoading(false);\n        }\n    };\n\n    const renderMessages = () => (\n        <Div>\n            <AnimatePresence initial={false}>\n                {messages.map((msg) => (\n                    <motion.div\n                        key={msg.key}\n                        initial={{opacity: 0, y: 10}}\n                        animate={{opacity: 1, y: 0}}\n                        exit={{opacity: 0, y: 10}}\n                        transition={{duration: 0.3}}\n                        style={{\n                            display: \"flex\",\n                            justifyContent: msg.from === \"user\" ? \"flex-end\" : \"flex-start\",\n                            marginBottom: 10,\n                        }}\n                    >\n                        <div\n                            style={{\n                                background: msg.from === \"user\" ? \"#f0e8dd\" : \"#e3d5c4\",\n                                color: \"#1c1c1c\",\n                                padding: \"10px 14px\",\n                                borderRadius: \"16px\",\n                                display: \"inline-block\",\n                                maxWidth: \"75%\",\n                                wordBreak: \"break-word\",\n                            }}\n                        >\n                            {msg.text}\n                        </div>\n                    </motion.div>\n                ))}\n            </AnimatePresence>\n            {/* Элемент для автоскролла */}\n            <div ref={messagesEndRef}/>\n        </Div>\n    );\n\n    // Отображаем экран загрузки, пока не загружены все шрифты\n    if (!fontsLoaded) {\n        return (\n            <div\n                style={{\n                    position: \"fixed\",\n                    top: 0,\n                    left: 0,\n                    width: \"100vw\",\n                    height: \"100vh\",\n                    backgroundColor: \"#FDF7F0\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    zIndex: 9999,\n                }}\n            >\n                <div className=\"loader\"></div>\n            </div>\n        );\n    }\n\n    return (\n        <ConfigProvider>\n            <AdaptivityProvider>\n                <div\n                    className=\"theme\"\n                    style={{\n                        width: \"100%\",\n                        height: \"100%\",\n                        overflow: \"hidden\",\n                        backgroundColor: \"#FDF7F0\",\n                    }}\n                >\n                    <AppRoot>\n                        <SplitLayout style={{width: \"100%\", height: \"100%\"}}>\n                            <SplitCol style={{width: \"100%\", height: \"100%\"}}>\n                                <View activePanel={activePanel}>\n                                    <Panel id=\"intro\">\n                                        <Div\n                                            style={{\n                                                display: \"flex\",\n                                                flexDirection: \"column\",\n                                                justifyContent: \"space-between\",\n                                                minHeight: \"100vh\",\n                                                backgroundColor: \"#fdf7f0\",\n                                                padding: 0,\n                                            }}\n                                        >\n                                            <div style={{position: \"relative\"}}>\n                                                <img\n                                                    src=\"https://i.pinimg.com/736x/01/90/d6/0190d61dbacf5e04320ca41c47da3d6c.jpg\"\n                                                    alt=\"Вдохновители\"\n                                                    style={{\n                                                        width: \"100%\",\n                                                        objectFit: \"cover\",\n                                                        maxHeight: \"200px\",\n                                                    }}\n                                                />\n                                                <div\n                                                    style={{\n                                                        position: \"absolute\",\n                                                        top: \"20%\",\n                                                        left: \"10%\",\n                                                        color: \"#254E2E\",\n                                                        font: \"Anticva\",\n                                                        fontSize: \"20px\",\n                                                        fontWeight: \"bold\",\n                                                    }}\n                                                >\n                                                    БЛАГО ОБЩЕЕ <br/> ВЫШЕ МОЕГО\n                                                </div>\n                                            </div>\n\n                                            <Div\n                                                style={{\n                                                    padding: \"20px\",\n                                                    background: \"#ffffff\",\n                                                    borderRadius: \"12px\",\n                                                    boxShadow: \"0px 6px 12px rgba(0, 0, 0, 0.1)\",\n                                                }}\n                                            >\n                                                <p\n                                                    style={{\n                                                        color: \"#6C828D\",\n                                                        font: \"montserrat\",\n                                                        lineHeight: \"1.6\",\n                                                    }}\n                                                >\n                                                    Добро пожаловать в приложение{\" \"}\n                                                    <strong>«Кто ты из героев прошлого?»</strong> — часть\n                                                    проекта <strong>«Вдохновители»</strong>.\n                                                </p>\n                                                <p\n                                                    style={{\n                                                        color: \"#6C828D\",\n                                                        font: \"montserrat\",\n                                                        lineHeight: \"1.6\",\n                                                    }}\n                                                >\n                                                    Этот сервис создан, чтобы каждый мог почувствовать\n                                                    личную связь с историей Великой Отечественной войны.\n                                                </p>\n                                                <p\n                                                    style={{\n                                                        color: \"#6C828D\",\n                                                        font: \"CodeNext\",\n                                                        lineHeight: \"1.6\",\n                                                    }}\n                                                >\n                                                    Отвечай на вопросы, рассказывая о себе — свободно и\n                                                    искренне.\n                                                    <br/>\n                                                    После этого ты узнаешь, на кого из героев прошлого ты\n                                                    похож.\n                                                    <br/>И сможешь поделиться результатом в соцсетях.\n                                                </p>\n                                            </Div>\n                                            <div\n                                                style={{\n                                                    position: \"sticky\",\n                                                    bottom: 0,\n                                                    backgroundColor: \"#f0e8dd\",\n                                                    padding: \"12px 16px\",\n                                                    zIndex: 10,\n                                                }}\n                                            >\n                                                <Button\n                                                    size=\"l\"\n                                                    stretched\n                                                    style={{\n                                                        marginTop: 8,\n                                                        backgroundColor: \"#30663d\",\n                                                        color: \"#b6d3b6\",\n                                                    }}\n                                                    onClick={() => setActivePanel(\"chat\")}\n                                                >\n                                                    Начать\n                                                </Button>\n                                            </div>\n                                        </Div>\n                                    </Panel>\n\n                                    <Panel id=\"chat\">\n                                        {showPinnedMessage && (\n                                            <div\n                                                style={{\n                                                    backgroundColor: \"#e0d6c8\", // чуть темнее фона чата\n                                                    padding: \"10px 14px\",\n                                                    display: \"flex\",\n                                                    alignItems: \"center\",\n                                                    justifyContent: \"space-between\",\n                                                    borderBottom: \"1px solid #ccc\",\n                                                    position: \"relative\",\n                                                    zIndex: 19, // чуть ниже шапки\n                                                }}\n                                            >\n                                                <div style={{color: \"#1c1c1c\", fontSize: \"14px\", flex: 1}}>\n                                                    ⚠️ Пожалуйста, отвечайте честно — это поможет подобрать героя\n                                                    точнее.\n                                                </div>\n                                                <div\n                                                    onClick={() => setShowPinnedMessage(false)}\n                                                    style={{\n                                                        marginLeft: \"12px\",\n                                                        cursor: \"pointer\",\n                                                        fontSize: \"18px\",\n                                                        color: \"#888\",\n                                                        lineHeight: \"1\",\n                                                    }}\n                                                >\n                                                    ×\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        <div\n                                            style={{\n                                                display: \"flex\",\n                                                flexDirection: \"column\",\n                                                height: \"100vh\",\n                                                position: \"relative\",\n                                                background: \"#FDF7F0\",\n                                                overflow: \"hidden\",\n                                            }}\n                                        >\n                                            <div\n                                                style={{\n                                                    backgroundColor: \"#f0e8dd\",\n                                                    padding: \"12px 16px\",\n                                                    borderBottom: \"1px solid #aaa\",\n                                                    display: \"flex\",\n                                                    alignItems: \"center\",\n                                                    position: \"fixed\",\n                                                    top: 0,\n                                                    left: 0,\n                                                    right: 0,\n                                                    zIndex: 20,\n                                                }}\n                                            >\n                                                <img\n                                                    src=\"https://i.pinimg.com/736x/01/90/d6/0190d61dbacf5e04320ca41c47da3d6c.jpg\"\n                                                    alt=\"Твой герой победы\"\n                                                    style={{\n                                                        width: 40,\n                                                        height: 40,\n                                                        borderRadius: \"50%\",\n                                                        objectFit: \"cover\",\n                                                        marginRight: 12,\n                                                    }}\n                                                />\n                                                <div>\n                                                    <div\n                                                        style={{\n                                                            fontWeight: \"bold\",\n                                                            fontSize: 16,\n                                                            color: \"#254E2E\",\n                                                        }}\n                                                    >\n                                                        Твой герой победы\n                                                    </div>\n                                                    {loading && (\n                                                        <div style={{fontSize: 12, color: \"#1c1c1c\"}}>\n                                                            печатает...\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </div>\n                                            <div\n                                                style={{\n                                                    flex: \"1 1 auto\",\n                                                    overflowY: \"auto\",\n                                                    padding: \"16px\",\n                                                    marginTop: showPinnedMessage ? 120 : 65,\n                                                }}\n                                            >\n                                                {renderMessages()}\n                                                {characterImage && (\n                                                    <motion.div\n                                                        initial={{opacity: 0, scale: 0.9}}\n                                                        animate={{opacity: 1, scale: 1}}\n                                                        transition={{duration: 0.5}}\n                                                    >\n                                                        <Div>\n                                                            <img\n                                                                src={characterImage}\n                                                                alt=\"Character\"\n                                                                style={{\n                                                                    maxWidth: \"100%\",\n                                                                    height: \"auto\",\n                                                                    borderRadius: \"8px\",\n                                                                    marginTop: \"20px\",\n                                                                    maxHeight: \"400px\",\n                                                                }}\n                                                            />\n                                                        </Div>\n                                                    </motion.div>\n                                                )}\n                                            </div>\n                                            {!finished ? (\n                                                <div\n                                                    style={{\n                                                        position: \"sticky\",\n                                                        bottom: 0,\n                                                        backgroundColor: \"#f0e8dd\",\n                                                        padding: \"12px 16px\",\n                                                        zIndex: 10,\n                                                    }}\n                                                >\n                                                    <Textarea\n                                                        value={input}\n                                                        onChange={(e) => setInput(e.target.value)}\n                                                        onKeyDown={(e) => {\n                                                            if (e.key === \"Enter\" && !e.shiftKey) {\n                                                                e.preventDefault();\n                                                                sendAnswer();\n                                                            }\n                                                        }}\n                                                        placeholder=\"Введите ответ...\"\n                                                        style={{\n                                                            backgroundColor: \"rgba(84,129,84,0.76)\",\n                                                            color: \"#1c1c1c\",\n                                                            borderRadius: \"12px\",\n                                                            padding: \"10px\",\n                                                            fontSize: \"16px\",\n                                                            resize: \"none\",\n                                                        }}\n                                                    />\n                                                    <Button\n                                                        size=\"l\"\n                                                        stretched\n                                                        style={{\n                                                            marginTop: 8,\n                                                            backgroundColor: \"#30663d\",\n                                                            color: \"#b6d3b6\",\n                                                        }}\n                                                        onClick={sendAnswer}\n                                                        loading={loading}\n                                                    >\n                                                        Отправить\n                                                    </Button>\n                                                </div>\n                                            ) : characterImage ? (\n                                                <Div\n                                                    style={{\n                                                        padding: \"16px\",\n                                                        display: \"flex\",\n                                                        flexDirection: \"column\",\n                                                        gap: \"12px\",\n                                                        backgroundColor: \"#fdf7f0\",\n                                                        borderTop: \"1px solid #ddd\",\n                                                    }}\n                                                >\n                                                    <Button\n                                                        size=\"l\"\n                                                        stretched\n                                                        style={{\n                                                            backgroundColor: \"#30663d\",\n                                                            color: \"#ffffff\",\n                                                        }}\n                                                        onClick={async () => {\n                                                            if (!characterImage) return;\n                                                            try {\n                                                                await bridge.send(\"VKWebAppShowStoryBox\", {\n                                                                        background_type: \"image\",\n                                                                        blob: characterImage,\n                                                                        attachment: {\n                                                                            text: 'open',\n                                                                            type: 'url',\n                                                                            url: \"https://vk.com/app53519220\"\n                                                                        }\n                                                                    }\n                                                                )\n                                                                const res = await fetch(\n                                                                    \"https://xn-----dlccdmca1acd3bode5aey.xn--p1ai:8000/edit_stat\",\n                                                                    {method: \"POST\"}\n                                                                );\n\n\n                                                            } catch (err) {\n                                                                console.error(\"Ошибка шэринга:\", err);\n                                                            }\n                                                        }}\n                                                    >\n                                                        Рассказать о моем герое в ВК историях\n                                                    </Button>\n                                                    <Button\n                                                        size=\"l\"\n                                                        stretched\n                                                        style={{\n                                                            backgroundColor: \"#30663d\",\n                                                            color: \"#ffffff\",\n                                                        }}\n                                                        href=\"https://xn--b1aaffobumib0c5a.xn--p1ai/\"\n                                                        target=\"_blank\"\n                                                    >\n                                                        Узнать больше о движении Вдохновители\n                                                    </Button>\n                                                    <Button\n                                                        size=\"l\"\n                                                        stretched\n                                                        style={{\n                                                            backgroundColor: \"#30663d\",\n                                                            color: \"#ffffff\",\n                                                        }}\n                                                        href=\"https://xn----dtbbicare8alexe.xn--p1ai/\"\n                                                        target=\"_blank\"\n                                                    >\n                                                        Узнать истории других героев\n                                                    </Button>\n                                                </Div>\n                                            ) : null}\n                                        </div>\n                                    </Panel>\n                                </View>\n                            </SplitCol>\n                        </SplitLayout>\n                    </AppRoot>\n                </div>\n            </AdaptivityProvider>\n        </ConfigProvider>\n    );\n};\nexport default App;"],"mappings":"AAAA,MAAO,CAAAA,MAAM,KAAM,sBAAsB,CACzC,OACIC,kBAAkB,CAClBC,OAAO,CACPC,MAAM,CACNC,cAAc,CACdC,GAAG,CACHC,KAAK,CACLC,QAAQ,CACRC,WAAW,CACXC,QAAQ,CACRC,IAAI,KACD,iBAAiB,CACxB,MAAO,+BAA+B,CACtC,OAAQC,eAAe,CAAEC,MAAM,KAAO,eAAe,CACrD,MAAO,CAAAC,KAAK,EAAGC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAO,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEzD,KAAM,CAAAC,SAAS,CAAG,CACd,uJAAuJ,CACvJ,sFAAsF,CACtF,gGAAgG,CAChG,4IAA4I,CAC5I,gIAAgI,CAChI,sIAAsI,CACzI,CAED,KAAM,CAAAC,GAAG,CAAGA,CAAA,GAAM,CACd,KAAM,CAACC,WAAW,CAAEC,cAAc,CAAC,CAAGR,QAAQ,CAAC,OAAO,CAAC,CACvD,KAAM,CAACS,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGV,QAAQ,CAAC,CAAC,CAAC,CACnE,KAAM,CAACW,QAAQ,CAAEC,WAAW,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACe,KAAK,CAAEC,QAAQ,CAAC,CAAGhB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACiB,OAAO,CAAEC,UAAU,CAAC,CAAGlB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACmB,QAAQ,CAAEC,WAAW,CAAC,CAAGpB,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACqB,cAAc,CAAEC,iBAAiB,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CAC1D,KAAM,CAACuB,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGxB,QAAQ,CAAC,IAAI,CAAC,CACtE,KAAM,CAACyB,WAAW,CAAEC,cAAc,CAAC,CAAG1B,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAAA2B,cAAc,CAAG5B,MAAM,CAAC,IAAI,CAAC,CACnC,KAAM,CAAC6B,iBAAiB,CAAEC,oBAAoB,CAAC,CAAG7B,QAAQ,CAAC,IAAI,CAAC,CAGhE;AACA,KAAM,CAAA8B,gBAAgB,CAAG,IAAI,CAC7B,KAAM,CAACC,gBAAgB,CAAC,CAAG/B,QAAQ,CAACgC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CAE/C;AACAnC,SAAS,CAAC,IAAM,CACZoC,QAAQ,CAACC,KAAK,CAACC,KAAK,CAACC,IAAI,CAAC,IAAM,CAC5B,KAAM,CAAAC,OAAO,CAAGN,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGF,gBAAgB,CAC7C,KAAM,CAAAQ,KAAK,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEX,gBAAgB,CAAGQ,OAAO,CAAC,CACrDI,UAAU,CAAC,IAAMhB,cAAc,CAAC,IAAI,CAAC,CAAEa,KAAK,CAAC,CACjD,CAAC,CAAC,CACN,CAAC,CAAE,CAACR,gBAAgB,CAAC,CAAC,CAEtB;AACA,KAAM,CAAAY,aAAa,CACf,cAAc,EAAI,CAAAC,MAAM,EAAIC,SAAS,CAACC,cAAc,CAAG,CAAC,CAC5D,KAAM,CAACC,cAAc,CAAEC,iBAAiB,CAAC,CAAGhD,QAAQ,CAAC4C,MAAM,CAACK,WAAW,CAAC,CAExEnD,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAoD,YAAY,CAAGA,CAAA,GAAM,CACvBF,iBAAiB,CAACJ,MAAM,CAACK,WAAW,CAAC,CACzC,CAAC,CAEDL,MAAM,CAACO,gBAAgB,CAAC,QAAQ,CAAED,YAAY,CAAC,CAC/C,MAAO,IAAMN,MAAM,CAACQ,mBAAmB,CAAC,QAAQ,CAAEF,YAAY,CAAC,CACnE,CAAC,CAAE,EAAE,CAAC,CAEN;AACApD,SAAS,CAAC,IAAM,CACZ,GAAI6C,aAAa,EAAIhB,cAAc,CAAC0B,OAAO,CAAE,CACzC1B,cAAc,CAAC0B,OAAO,CAACC,cAAc,CAAC,CAClCC,QAAQ,CAAE,QAAQ,CAClBC,KAAK,CAAE,KACX,CAAC,CAAC,CACN,CACJ,CAAC,CAAE,CAAC7C,QAAQ,CAAEgC,aAAa,CAAEI,cAAc,CAAC,CAAC,CAE7CjD,SAAS,CAAC,IAAM,CACZ,GAAIS,WAAW,GAAK,MAAM,EAAII,QAAQ,CAAC8C,MAAM,GAAK,CAAC,CAAE,CACjD7C,WAAW,CAAC,CAAC,CAAC8C,IAAI,CAAErD,SAAS,CAAC,CAAC,CAAC,CAAEsD,IAAI,CAAE,KAAK,CAAEC,GAAG,CAAE5B,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CACrE,CACJ,CAAC,CAAE,CAAC1B,WAAW,CAAEI,QAAQ,CAAC8C,MAAM,CAAC,CAAC,CAElC,KAAM,CAAAI,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAI,CAAC9C,KAAK,CAAC+C,IAAI,CAAC,CAAC,CAAE,OAEnB,KAAM,CAAAC,UAAU,CAAGhD,KAAK,CAAC+C,IAAI,CAAC,CAAC,CAC/B,KAAM,CAAAE,YAAY,CAAG3D,SAAS,CAACI,oBAAoB,CAAC,CAEpD,KAAM,CAAAwD,WAAW,CAAG,CAACP,IAAI,CAAEK,UAAU,CAAEJ,IAAI,CAAE,MAAM,CAAEC,GAAG,CAAE5B,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CACrE,KAAM,CAAAiC,cAAc,CAAG,CACnB,GAAGrD,OAAO,CACV,CAACsD,QAAQ,CAAEH,YAAY,CAAEI,MAAM,CAAEL,UAAU,CAAC,CAC/C,CAEDnD,WAAW,CAAEyD,IAAI,EAAK,CAAC,GAAGA,IAAI,CAAEJ,WAAW,CAAC,CAAC,CAC7CnD,UAAU,CAACoD,cAAc,CAAC,CAC1BlD,QAAQ,CAAC,EAAE,CAAC,CACZE,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAoD,SAAS,CAAG7D,oBAAoB,CAAG,CAAC,CAG1C,GAAI6D,SAAS,CAAGjE,SAAS,CAACoD,MAAM,CAAE,CAC9Bf,UAAU,CAAC,IAAM,CACb,KAAM,CAAA6B,WAAW,CAAG,CAChBb,IAAI,CAAErD,SAAS,CAACiE,SAAS,CAAC,CAC1BX,IAAI,CAAE,KAAK,CACXC,GAAG,CAAE5B,IAAI,CAACC,GAAG,CAAC,CAClB,CAAC,CACDrB,WAAW,CAAEyD,IAAI,EAAK,CAAC,GAAGA,IAAI,CAAEE,WAAW,CAAC,CAAC,CAC7C7D,uBAAuB,CAAC4D,SAAS,CAAC,CAClCpD,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAE,GAAG,CAAC,CACX,CAAC,IAAM,CACHE,WAAW,CAAC,IAAI,CAAC,CACjB,GAAI,CACAR,WAAW,CAAEyD,IAAI,EAAK,CAClB,GAAGA,IAAI,CACP,CACIX,IAAI,CAAE,oEAAoE,CAC1EC,IAAI,CAAE,KAAK,CACXC,GAAG,CAAE5B,IAAI,CAACC,GAAG,CAAC,CAClB,CAAC,CACJ,CAAC,CACF,KAAM,CAAAuC,GAAG,CAAG,KAAM,CAAAC,KAAK,CACnB,8DAA8D,CAC9D,CACIC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CAAC,cAAc,CAAE,kBAAkB,CAAC,CAC7CC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACjBC,OAAO,CAAE,UAAU,CACnBC,QAAQ,CAAE,OAAO,CACjBnE,OAAO,CAAEqD,cACb,CAAC,CACL,CACJ,CAAC,CAED,GAAI,CAACM,GAAG,CAACS,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,uBAAuB,CAAC,CACrD,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAX,GAAG,CAACW,IAAI,CAAC,CAAC,CAC7B,KAAM,CAAAC,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC/BD,MAAM,CAACE,SAAS,CAAG,IAAM,CACrB;AACA,KAAM,CAAAC,OAAO,CAAGH,MAAM,CAACI,MAAM,CAC7BlE,iBAAiB,CAACiE,OAAO,CAAC,CAC1B;AACA/D,uBAAuB,CAAC+D,OAAO,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAClD,CAAC,CACDL,MAAM,CAACM,aAAa,CAACP,IAAI,CAAC,CAC9B,CAAE,MAAOQ,KAAK,CAAE,CACZ/E,WAAW,CAAEyD,IAAI,EAAK,CAClB,GAAGA,IAAI,CACP,CAACX,IAAI,CAAE,2BAA2B,CAAEC,IAAI,CAAE,KAAK,CAAEC,GAAG,CAAE5B,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CACpE,CAAC,CACN,CAEAf,UAAU,CAAC,KAAK,CAAC,CACrB,CACJ,CAAC,CAED,KAAM,CAAA0E,cAAc,CAAGA,CAAA,gBACnBxF,KAAA,CAACf,GAAG,EAAAwG,QAAA,eACA3F,IAAA,CAACP,eAAe,EAACmG,OAAO,CAAE,KAAM,CAAAD,QAAA,CAC3BlF,QAAQ,CAACoF,GAAG,CAAEC,GAAG,eACd9F,IAAA,CAACN,MAAM,CAACqG,GAAG,EAEPH,OAAO,CAAE,CAACI,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,EAAE,CAAE,CAC7BC,OAAO,CAAE,CAACF,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAC,CAAE,CAC5BE,IAAI,CAAE,CAACH,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,EAAE,CAAE,CAC1BG,UAAU,CAAE,CAACC,QAAQ,CAAE,GAAG,CAAE,CAC5BC,KAAK,CAAE,CACHC,OAAO,CAAE,MAAM,CACfC,cAAc,CAAEV,GAAG,CAACrC,IAAI,GAAK,MAAM,CAAG,UAAU,CAAG,YAAY,CAC/DgD,YAAY,CAAE,EAClB,CAAE,CAAAd,QAAA,cAEF3F,IAAA,QACIsG,KAAK,CAAE,CACHI,UAAU,CAAEZ,GAAG,CAACrC,IAAI,GAAK,MAAM,CAAG,SAAS,CAAG,SAAS,CACvDkD,KAAK,CAAE,SAAS,CAChBC,OAAO,CAAE,WAAW,CACpBC,YAAY,CAAE,MAAM,CACpBN,OAAO,CAAE,cAAc,CACvBO,QAAQ,CAAE,KAAK,CACfC,SAAS,CAAE,YACf,CAAE,CAAApB,QAAA,CAEDG,GAAG,CAACtC,IAAI,CACR,CAAC,EAvBDsC,GAAG,CAACpC,GAwBD,CACf,CAAC,CACW,CAAC,cAElB1D,IAAA,QAAKgH,GAAG,CAAEvF,cAAe,CAAC,CAAC,EAC1B,CACR,CAED;AACA,GAAI,CAACF,WAAW,CAAE,CACd,mBACIvB,IAAA,QACIsG,KAAK,CAAE,CACHW,QAAQ,CAAE,OAAO,CACjBC,GAAG,CAAE,CAAC,CACNC,IAAI,CAAE,CAAC,CACPC,KAAK,CAAE,OAAO,CACdC,MAAM,CAAE,OAAO,CACfC,eAAe,CAAE,SAAS,CAC1Bf,OAAO,CAAE,MAAM,CACfgB,UAAU,CAAE,QAAQ,CACpBf,cAAc,CAAE,QAAQ,CACxBgB,MAAM,CAAE,IACZ,CAAE,CAAA7B,QAAA,cAEF3F,IAAA,QAAKyH,SAAS,CAAC,QAAQ,CAAM,CAAC,CAC7B,CAAC,CAEd,CAEA,mBACIzH,IAAA,CAACd,cAAc,EAAAyG,QAAA,cACX3F,IAAA,CAACjB,kBAAkB,EAAA4G,QAAA,cACf3F,IAAA,QACIyH,SAAS,CAAC,OAAO,CACjBnB,KAAK,CAAE,CACHc,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdK,QAAQ,CAAE,QAAQ,CAClBJ,eAAe,CAAE,SACrB,CAAE,CAAA3B,QAAA,cAEF3F,IAAA,CAAChB,OAAO,EAAA2G,QAAA,cACJ3F,IAAA,CAACV,WAAW,EAACgH,KAAK,CAAE,CAACc,KAAK,CAAE,MAAM,CAAEC,MAAM,CAAE,MAAM,CAAE,CAAA1B,QAAA,cAChD3F,IAAA,CAACX,QAAQ,EAACiH,KAAK,CAAE,CAACc,KAAK,CAAE,MAAM,CAAEC,MAAM,CAAE,MAAM,CAAE,CAAA1B,QAAA,cAC7CzF,KAAA,CAACV,IAAI,EAACa,WAAW,CAAEA,WAAY,CAAAsF,QAAA,eAC3B3F,IAAA,CAACZ,KAAK,EAACuI,EAAE,CAAC,OAAO,CAAAhC,QAAA,cACbzF,KAAA,CAACf,GAAG,EACAmH,KAAK,CAAE,CACHC,OAAO,CAAE,MAAM,CACfqB,aAAa,CAAE,QAAQ,CACvBpB,cAAc,CAAE,eAAe,CAC/BqB,SAAS,CAAE,OAAO,CAClBP,eAAe,CAAE,SAAS,CAC1BV,OAAO,CAAE,CACb,CAAE,CAAAjB,QAAA,eAEFzF,KAAA,QAAKoG,KAAK,CAAE,CAACW,QAAQ,CAAE,UAAU,CAAE,CAAAtB,QAAA,eAC/B3F,IAAA,QACI8H,GAAG,CAAC,yEAAyE,CAC7EC,GAAG,CAAC,0EAAc,CAClBzB,KAAK,CAAE,CACHc,KAAK,CAAE,MAAM,CACbY,SAAS,CAAE,OAAO,CAClBC,SAAS,CAAE,OACf,CAAE,CACL,CAAC,cACF/H,KAAA,QACIoG,KAAK,CAAE,CACHW,QAAQ,CAAE,UAAU,CACpBC,GAAG,CAAE,KAAK,CACVC,IAAI,CAAE,KAAK,CACXR,KAAK,CAAE,SAAS,CAChBuB,IAAI,CAAE,SAAS,CACfC,QAAQ,CAAE,MAAM,CAChBC,UAAU,CAAE,MAChB,CAAE,CAAAzC,QAAA,EACL,gEACe,cAAA3F,IAAA,QAAI,CAAC,2DACrB,EAAK,CAAC,EACL,CAAC,cAENE,KAAA,CAACf,GAAG,EACAmH,KAAK,CAAE,CACHM,OAAO,CAAE,MAAM,CACfF,UAAU,CAAE,SAAS,CACrBG,YAAY,CAAE,MAAM,CACpBwB,SAAS,CAAE,iCACf,CAAE,CAAA1C,QAAA,eAEFzF,KAAA,MACIoG,KAAK,CAAE,CACHK,KAAK,CAAE,SAAS,CAChBuB,IAAI,CAAE,YAAY,CAClBI,UAAU,CAAE,KAChB,CAAE,CAAA3C,QAAA,EACL,iKACgC,CAAC,GAAG,cACjC3F,IAAA,WAAA2F,QAAA,CAAQ,6IAA4B,CAAQ,CAAC,qFACrC,cAAA3F,IAAA,WAAA2F,QAAA,CAAQ,kFAAc,CAAQ,CAAC,IAC3C,EAAG,CAAC,cACJ3F,IAAA,MACIsG,KAAK,CAAE,CACHK,KAAK,CAAE,SAAS,CAChBuB,IAAI,CAAE,YAAY,CAClBI,UAAU,CAAE,KAChB,CAAE,CAAA3C,QAAA,CACL,iiBAGD,CAAG,CAAC,cACJzF,KAAA,MACIoG,KAAK,CAAE,CACHK,KAAK,CAAE,SAAS,CAChBuB,IAAI,CAAE,UAAU,CAChBI,UAAU,CAAE,KAChB,CAAE,CAAA3C,QAAA,EACL,yTAGG,cAAA3F,IAAA,QAAI,CAAC,+SAGL,cAAAA,IAAA,QAAI,CAAC,6OACT,EAAG,CAAC,EACH,CAAC,cACNA,IAAA,QACIsG,KAAK,CAAE,CACHW,QAAQ,CAAE,QAAQ,CAClBsB,MAAM,CAAE,CAAC,CACTjB,eAAe,CAAE,SAAS,CAC1BV,OAAO,CAAE,WAAW,CACpBY,MAAM,CAAE,EACZ,CAAE,CAAA7B,QAAA,cAEF3F,IAAA,CAACf,MAAM,EACHuJ,IAAI,CAAC,GAAG,CACRC,SAAS,MACTnC,KAAK,CAAE,CACHoC,SAAS,CAAE,CAAC,CACZpB,eAAe,CAAE,SAAS,CAC1BX,KAAK,CAAE,SACX,CAAE,CACFgC,OAAO,CAAEA,CAAA,GAAMrI,cAAc,CAAC,MAAM,CAAE,CAAAqF,QAAA,CACzC,sCAED,CAAQ,CAAC,CACR,CAAC,EACL,CAAC,CACH,CAAC,cAERzF,KAAA,CAACd,KAAK,EAACuI,EAAE,CAAC,MAAM,CAAAhC,QAAA,EACXjE,iBAAiB,eACdxB,KAAA,QACIoG,KAAK,CAAE,CACHgB,eAAe,CAAE,SAAS,CAAE;AAC5BV,OAAO,CAAE,WAAW,CACpBL,OAAO,CAAE,MAAM,CACfgB,UAAU,CAAE,QAAQ,CACpBf,cAAc,CAAE,eAAe,CAC/BoC,YAAY,CAAE,gBAAgB,CAC9B3B,QAAQ,CAAE,UAAU,CACpBO,MAAM,CAAE,EAAI;AAChB,CAAE,CAAA7B,QAAA,eAEF3F,IAAA,QAAKsG,KAAK,CAAE,CAACK,KAAK,CAAE,SAAS,CAAEwB,QAAQ,CAAE,MAAM,CAAEU,IAAI,CAAE,CAAC,CAAE,CAAAlD,QAAA,CAAC,yWAG3D,CAAK,CAAC,cACN3F,IAAA,QACI2I,OAAO,CAAEA,CAAA,GAAMhH,oBAAoB,CAAC,KAAK,CAAE,CAC3C2E,KAAK,CAAE,CACHwC,UAAU,CAAE,MAAM,CAClBC,MAAM,CAAE,SAAS,CACjBZ,QAAQ,CAAE,MAAM,CAChBxB,KAAK,CAAE,MAAM,CACb2B,UAAU,CAAE,GAChB,CAAE,CAAA3C,QAAA,CACL,MAED,CAAK,CAAC,EACL,CACR,cAEDzF,KAAA,QACIoG,KAAK,CAAE,CACHC,OAAO,CAAE,MAAM,CACfqB,aAAa,CAAE,QAAQ,CACvBP,MAAM,CAAE,OAAO,CACfJ,QAAQ,CAAE,UAAU,CACpBP,UAAU,CAAE,SAAS,CACrBgB,QAAQ,CAAE,QACd,CAAE,CAAA/B,QAAA,eAEFzF,KAAA,QACIoG,KAAK,CAAE,CACHgB,eAAe,CAAE,SAAS,CAC1BV,OAAO,CAAE,WAAW,CACpBgC,YAAY,CAAE,gBAAgB,CAC9BrC,OAAO,CAAE,MAAM,CACfgB,UAAU,CAAE,QAAQ,CACpBN,QAAQ,CAAE,OAAO,CACjBC,GAAG,CAAE,CAAC,CACNC,IAAI,CAAE,CAAC,CACP6B,KAAK,CAAE,CAAC,CACRxB,MAAM,CAAE,EACZ,CAAE,CAAA7B,QAAA,eAEF3F,IAAA,QACI8H,GAAG,CAAC,yEAAyE,CAC7EC,GAAG,CAAC,8FAAmB,CACvBzB,KAAK,CAAE,CACHc,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVR,YAAY,CAAE,KAAK,CACnBmB,SAAS,CAAE,OAAO,CAClBiB,WAAW,CAAE,EACjB,CAAE,CACL,CAAC,cACF/I,KAAA,QAAAyF,QAAA,eACI3F,IAAA,QACIsG,KAAK,CAAE,CACH8B,UAAU,CAAE,MAAM,CAClBD,QAAQ,CAAE,EAAE,CACZxB,KAAK,CAAE,SACX,CAAE,CAAAhB,QAAA,CACL,8FAED,CAAK,CAAC,CACL5E,OAAO,eACJf,IAAA,QAAKsG,KAAK,CAAE,CAAC6B,QAAQ,CAAE,EAAE,CAAExB,KAAK,CAAE,SAAS,CAAE,CAAAhB,QAAA,CAAC,qDAE9C,CAAK,CACR,EACA,CAAC,EACL,CAAC,cACNzF,KAAA,QACIoG,KAAK,CAAE,CACHuC,IAAI,CAAE,UAAU,CAChBK,SAAS,CAAE,MAAM,CACjBtC,OAAO,CAAE,MAAM,CACf8B,SAAS,CAAEhH,iBAAiB,CAAG,GAAG,CAAG,EACzC,CAAE,CAAAiE,QAAA,EAEDD,cAAc,CAAC,CAAC,CAChBvE,cAAc,eACXnB,IAAA,CAACN,MAAM,CAACqG,GAAG,EACPH,OAAO,CAAE,CAACI,OAAO,CAAE,CAAC,CAAEmD,KAAK,CAAE,GAAG,CAAE,CAClCjD,OAAO,CAAE,CAACF,OAAO,CAAE,CAAC,CAAEmD,KAAK,CAAE,CAAC,CAAE,CAChC/C,UAAU,CAAE,CAACC,QAAQ,CAAE,GAAG,CAAE,CAAAV,QAAA,cAE5B3F,IAAA,CAACb,GAAG,EAAAwG,QAAA,cACA3F,IAAA,QACI8H,GAAG,CAAE3G,cAAe,CACpB4G,GAAG,CAAC,WAAW,CACfzB,KAAK,CAAE,CACHQ,QAAQ,CAAE,MAAM,CAChBO,MAAM,CAAE,MAAM,CACdR,YAAY,CAAE,KAAK,CACnB6B,SAAS,CAAE,MAAM,CACjBT,SAAS,CAAE,OACf,CAAE,CACL,CAAC,CACD,CAAC,CACE,CACf,EACA,CAAC,CACL,CAAChH,QAAQ,cACNf,KAAA,QACIoG,KAAK,CAAE,CACHW,QAAQ,CAAE,QAAQ,CAClBsB,MAAM,CAAE,CAAC,CACTjB,eAAe,CAAE,SAAS,CAC1BV,OAAO,CAAE,WAAW,CACpBY,MAAM,CAAE,EACZ,CAAE,CAAA7B,QAAA,eAEF3F,IAAA,CAACT,QAAQ,EACL6J,KAAK,CAAEvI,KAAM,CACbwI,QAAQ,CAAGC,CAAC,EAAKxI,QAAQ,CAACwI,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAC1CI,SAAS,CAAGF,CAAC,EAAK,CACd,GAAIA,CAAC,CAAC5F,GAAG,GAAK,OAAO,EAAI,CAAC4F,CAAC,CAACG,QAAQ,CAAE,CAClCH,CAAC,CAACI,cAAc,CAAC,CAAC,CAClB/F,UAAU,CAAC,CAAC,CAChB,CACJ,CAAE,CACFgG,WAAW,CAAC,8EAAkB,CAC9BrD,KAAK,CAAE,CACHgB,eAAe,CAAE,sBAAsB,CACvCX,KAAK,CAAE,SAAS,CAChBE,YAAY,CAAE,MAAM,CACpBD,OAAO,CAAE,MAAM,CACfuB,QAAQ,CAAE,MAAM,CAChByB,MAAM,CAAE,MACZ,CAAE,CACL,CAAC,cACF5J,IAAA,CAACf,MAAM,EACHuJ,IAAI,CAAC,GAAG,CACRC,SAAS,MACTnC,KAAK,CAAE,CACHoC,SAAS,CAAE,CAAC,CACZpB,eAAe,CAAE,SAAS,CAC1BX,KAAK,CAAE,SACX,CAAE,CACFgC,OAAO,CAAEhF,UAAW,CACpB5C,OAAO,CAAEA,OAAQ,CAAA4E,QAAA,CACpB,wDAED,CAAQ,CAAC,EACR,CAAC,CACNxE,cAAc,cACdjB,KAAA,CAACf,GAAG,EACAmH,KAAK,CAAE,CACHM,OAAO,CAAE,MAAM,CACfL,OAAO,CAAE,MAAM,CACfqB,aAAa,CAAE,QAAQ,CACvBiC,GAAG,CAAE,MAAM,CACXvC,eAAe,CAAE,SAAS,CAC1BwC,SAAS,CAAE,gBACf,CAAE,CAAAnE,QAAA,eAEF3F,IAAA,CAACf,MAAM,EACHuJ,IAAI,CAAC,GAAG,CACRC,SAAS,MACTnC,KAAK,CAAE,CACHgB,eAAe,CAAE,SAAS,CAC1BX,KAAK,CAAE,SACX,CAAE,CACFgC,OAAO,CAAE,KAAAA,CAAA,GAAY,CACjB,GAAI,CAACxH,cAAc,CAAE,OACrB,GAAI,CACA,KAAM,CAAArC,MAAM,CAACiL,IAAI,CAAC,sBAAsB,CAAE,CAClCC,eAAe,CAAE,OAAO,CACxB/E,IAAI,CAAE9D,cAAc,CACpB8I,UAAU,CAAE,CACRzG,IAAI,CAAE,MAAM,CACZ0G,IAAI,CAAE,KAAK,CACXC,GAAG,CAAE,4BACT,CACJ,CACJ,CAAC,CACD,KAAM,CAAA7F,GAAG,CAAG,KAAM,CAAAC,KAAK,CACnB,8DAA8D,CAC9D,CAACC,MAAM,CAAE,MAAM,CACnB,CAAC,CAGL,CAAE,MAAO4F,GAAG,CAAE,CACVC,OAAO,CAAC5E,KAAK,CAAC,iBAAiB,CAAE2E,GAAG,CAAC,CACzC,CACJ,CAAE,CAAAzE,QAAA,CACL,kMAED,CAAQ,CAAC,cACT3F,IAAA,CAACf,MAAM,EACHuJ,IAAI,CAAC,GAAG,CACRC,SAAS,MACTnC,KAAK,CAAE,CACHgB,eAAe,CAAE,SAAS,CAC1BX,KAAK,CAAE,SACX,CAAE,CACF2D,IAAI,CAAC,wCAAwC,CAC7Cf,MAAM,CAAC,QAAQ,CAAA5D,QAAA,CAClB,4MAED,CAAQ,CAAC,cACT3F,IAAA,CAACf,MAAM,EACHuJ,IAAI,CAAC,GAAG,CACRC,SAAS,MACTnC,KAAK,CAAE,CACHgB,eAAe,CAAE,SAAS,CAC1BX,KAAK,CAAE,SACX,CAAE,CACF2D,IAAI,CAAC,yCAAyC,CAC9Cf,MAAM,CAAC,QAAQ,CAAA5D,QAAA,CAClB,2JAED,CAAQ,CAAC,EACR,CAAC,CACN,IAAI,EACP,CAAC,EACH,CAAC,EACN,CAAC,CACD,CAAC,CACF,CAAC,CACT,CAAC,CACT,CAAC,CACU,CAAC,CACT,CAAC,CAEzB,CAAC,CACD,cAAe,CAAAvF,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}