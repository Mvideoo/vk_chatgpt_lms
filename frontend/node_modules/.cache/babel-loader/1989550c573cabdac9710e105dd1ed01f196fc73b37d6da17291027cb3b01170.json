{"ast":null,"code":"import { _ as _define_property } from \"@swc/helpers/_/_define_property\";\nconst defaultIframeStyles = {\n  position: 'absolute',\n  left: '0',\n  top: '0',\n  zIndex: '-1',\n  width: '100%',\n  height: '100%',\n  pointerEvents: 'none',\n  opacity: '0',\n  border: '0'\n};\n/*\n * Специальный CustomResizeObserver как fallback для ResizeObserver\n * Используется для вызова update() функции (перерисовка плавающего окна) floating-ui\n * при изменении размера reference или floating элементов.\n *\n * По умолчанию пытаемся нарисовать скрытый, абсолютно позиционированный относительно\n * наблюдаемого элемента iframe.\n * В случае же, если наблюдаемый элемент имеет position: static, то правильно спозиционировать\n * iframe у нас не получится, поэтому в такой ситуации мы используем MutationObserver.\n *\n * Использовать только MutationObserver мы не можем, потому что с помощью него нельзя отследить\n * изменение размера вызванное переполнением текста.\n *\n * Применяется только если нету поддержики или полифила ResizeObserver.\n * */\nexport class CustomResizeObserver {\n  observe(element) {\n    if (isPositioned(element)) {\n      return this.observeUsingIframe(element);\n    }\n    return this.observeUsingMutationObserver(element);\n  }\n  appendToTheDOM() {\n    for (let record of this.records) {\n      record.target.appendChild(record.iframe);\n    }\n    for (let record of this.records) {\n      if (record.iframe.contentWindow) {\n        record.iframe.contentWindow.addEventListener('resize', this.updateFunction);\n      }\n    }\n  }\n  observeUsingIframe(element) {\n    const iframe = element.ownerDocument.createElement('iframe');\n    iframe.ariaHidden = 'true';\n    iframe.tabIndex = -1;\n    Object.assign(iframe.style, defaultIframeStyles);\n    this.records.push({\n      target: element,\n      iframe\n    });\n  }\n  observeUsingMutationObserver(element) {\n    if (!this.mutationObserverFallback) {\n      this.mutationObserverFallback = new MutationObserver(this.updateFunction);\n    }\n    this.mutationObserverFallback.observe(element, {\n      childList: true,\n      subtree: true\n    });\n  }\n  disconnect() {\n    this.records.map(_ref => {\n      let {\n        target,\n        iframe\n      } = _ref;\n      if (iframe.contentWindow) {\n        iframe.contentWindow.removeEventListener('resize', this.updateFunction);\n      }\n      target.removeChild(iframe);\n    });\n    this.records = [];\n    if (this.mutationObserverFallback) {\n      this.mutationObserverFallback.disconnect();\n    }\n    this.mutationObserverFallback = null;\n  }\n  constructor(updateFunction) {\n    _define_property(this, \"records\", []);\n    _define_property(this, \"mutationObserverFallback\", null);\n    _define_property(this, \"updateFunction\", void 0);\n    this.updateFunction = updateFunction;\n  }\n}\nfunction isPositioned(element) {\n  return getComputedStyle(element).position !== 'static';\n}","map":{"version":3,"names":["defaultIframeStyles","position","left","top","zIndex","width","height","pointerEvents","opacity","border","CustomResizeObserver","observe","element","isPositioned","observeUsingIframe","observeUsingMutationObserver","appendToTheDOM","record","records","target","appendChild","iframe","contentWindow","addEventListener","updateFunction","ownerDocument","createElement","ariaHidden","tabIndex","Object","assign","style","push","mutationObserverFallback","MutationObserver","childList","subtree","disconnect","map","_ref","removeEventListener","removeChild","constructor","_define_property","getComputedStyle"],"sources":["/Users/viktoriaromazanova/PycharmProjects/vk_chatgpt/frontend/node_modules/@vkontakte/vkui/src/lib/floating/customResizeObserver.ts"],"sourcesContent":["const defaultIframeStyles: Pick<\n  CSSStyleDeclaration,\n  | 'position'\n  | 'left'\n  | 'top'\n  | 'zIndex'\n  | 'width'\n  | 'height'\n  | 'pointerEvents'\n  | 'opacity'\n  | 'border'\n> = {\n  position: 'absolute',\n  left: '0',\n  top: '0',\n  zIndex: '-1',\n  width: '100%',\n  height: '100%',\n  pointerEvents: 'none',\n  opacity: '0',\n  border: '0',\n};\n\n/*\n * Специальный CustomResizeObserver как fallback для ResizeObserver\n * Используется для вызова update() функции (перерисовка плавающего окна) floating-ui\n * при изменении размера reference или floating элементов.\n *\n * По умолчанию пытаемся нарисовать скрытый, абсолютно позиционированный относительно\n * наблюдаемого элемента iframe.\n * В случае же, если наблюдаемый элемент имеет position: static, то правильно спозиционировать\n * iframe у нас не получится, поэтому в такой ситуации мы используем MutationObserver.\n *\n * Использовать только MutationObserver мы не можем, потому что с помощью него нельзя отследить\n * изменение размера вызванное переполнением текста.\n *\n * Применяется только если нету поддержики или полифила ResizeObserver.\n * */\nexport class CustomResizeObserver {\n  records: Array<{\n    target: HTMLElement;\n    iframe: HTMLIFrameElement;\n  }> = [];\n  mutationObserverFallback: MutationObserver | null = null;\n  private readonly updateFunction: () => void;\n\n  constructor(updateFunction: () => void) {\n    this.updateFunction = updateFunction;\n  }\n\n  observe(element: HTMLElement): void {\n    if (isPositioned(element)) {\n      return this.observeUsingIframe(element);\n    }\n    return this.observeUsingMutationObserver(element);\n  }\n\n  appendToTheDOM(): void {\n    for (let record of this.records) {\n      record.target.appendChild(record.iframe);\n    }\n\n    for (let record of this.records) {\n      if (record.iframe.contentWindow) {\n        record.iframe.contentWindow.addEventListener('resize', this.updateFunction);\n      }\n    }\n  }\n\n  observeUsingIframe(element: HTMLElement): void {\n    const iframe = element.ownerDocument.createElement('iframe');\n    iframe.ariaHidden = 'true';\n    iframe.tabIndex = -1;\n    Object.assign(iframe.style, defaultIframeStyles);\n\n    this.records.push({ target: element, iframe });\n  }\n\n  observeUsingMutationObserver(element: HTMLElement): void {\n    if (!this.mutationObserverFallback) {\n      this.mutationObserverFallback = new MutationObserver(this.updateFunction);\n    }\n\n    this.mutationObserverFallback.observe(element, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  disconnect(): void {\n    this.records.map(({ target, iframe }) => {\n      if (iframe.contentWindow) {\n        iframe.contentWindow.removeEventListener('resize', this.updateFunction);\n      }\n\n      target.removeChild(iframe);\n    });\n    this.records = [];\n\n    if (this.mutationObserverFallback) {\n      this.mutationObserverFallback.disconnect();\n    }\n    this.mutationObserverFallback = null;\n  }\n}\n\nfunction isPositioned(element: HTMLElement): boolean {\n  return getComputedStyle(element).position !== 'static';\n}\n"],"mappings":";AAAA,MAAMA,mBAAA,GAWF;EACFC,QAAA,EAAU;EACVC,IAAA,EAAM;EACNC,GAAA,EAAK;EACLC,MAAA,EAAQ;EACRC,KAAA,EAAO;EACPC,MAAA,EAAQ;EACRC,aAAA,EAAe;EACfC,OAAA,EAAS;EACTC,MAAA,EAAQ;AACV;AAEA;;;;;;;;;;;;;;;AAeA,OAAO,MAAMC,oBAAA;EAYXC,QAAQC,OAAoB,EAAQ;IAClC,IAAIC,YAAA,CAAaD,OAAA,GAAU;MACzB,OAAO,IAAI,CAACE,kBAAkB,CAACF,OAAA;IACjC;IACA,OAAO,IAAI,CAACG,4BAA4B,CAACH,OAAA;EAC3C;EAEAI,eAAA,EAAuB;IACrB,KAAK,IAAIC,MAAA,IAAU,IAAI,CAACC,OAAO,EAAE;MAC/BD,MAAA,CAAOE,MAAM,CAACC,WAAW,CAACH,MAAA,CAAOI,MAAM;IACzC;IAEA,KAAK,IAAIJ,MAAA,IAAU,IAAI,CAACC,OAAO,EAAE;MAC/B,IAAID,MAAA,CAAOI,MAAM,CAACC,aAAa,EAAE;QAC/BL,MAAA,CAAOI,MAAM,CAACC,aAAa,CAACC,gBAAgB,CAAC,UAAU,IAAI,CAACC,cAAc;MAC5E;IACF;EACF;EAEAV,mBAAmBF,OAAoB,EAAQ;IAC7C,MAAMS,MAAA,GAAST,OAAA,CAAQa,aAAa,CAACC,aAAa,CAAC;IACnDL,MAAA,CAAOM,UAAU,GAAG;IACpBN,MAAA,CAAOO,QAAQ,GAAG,CAAC;IACnBC,MAAA,CAAOC,MAAM,CAACT,MAAA,CAAOU,KAAK,EAAE/B,mBAAA;IAE5B,IAAI,CAACkB,OAAO,CAACc,IAAI,CAAC;MAAEb,MAAA,EAAQP,OAAA;MAASS;IAAO;EAC9C;EAEAN,6BAA6BH,OAAoB,EAAQ;IACvD,IAAI,CAAC,IAAI,CAACqB,wBAAwB,EAAE;MAClC,IAAI,CAACA,wBAAwB,GAAG,IAAIC,gBAAA,CAAiB,IAAI,CAACV,cAAc;IAC1E;IAEA,IAAI,CAACS,wBAAwB,CAACtB,OAAO,CAACC,OAAA,EAAS;MAC7CuB,SAAA,EAAW;MACXC,OAAA,EAAS;IACX;EACF;EAEAC,WAAA,EAAmB;IACjB,IAAI,CAACnB,OAAO,CAACoB,GAAG,CAACC,IAAA,IAAmB;MAAA,IAAlB;QAAEpB,MAAM;QAAEE;MAAM,CAAE,GAAAkB,IAAA;MAClC,IAAIlB,MAAA,CAAOC,aAAa,EAAE;QACxBD,MAAA,CAAOC,aAAa,CAACkB,mBAAmB,CAAC,UAAU,IAAI,CAAChB,cAAc;MACxE;MAEAL,MAAA,CAAOsB,WAAW,CAACpB,MAAA;IACrB;IACA,IAAI,CAACH,OAAO,GAAG,EAAE;IAEjB,IAAI,IAAI,CAACe,wBAAwB,EAAE;MACjC,IAAI,CAACA,wBAAwB,CAACI,UAAU;IAC1C;IACA,IAAI,CAACJ,wBAAwB,GAAG;EAClC;EAzDAS,YAAYlB,cAA0B,EAAE;IAPxCmB,gBAAA,kBAGK,EAAE;IACPA,gBAAA,mCAAoD;IACpDA,gBAAA,OAAiB,kBAAjB;IAGE,IAAI,CAACnB,cAAc,GAAGA,cAAA;EACxB;AAwDF;AAEA,SAASX,aAAaD,OAAoB;EACxC,OAAOgC,gBAAA,CAAiBhC,OAAA,EAASX,QAAQ,KAAK;AAChD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}