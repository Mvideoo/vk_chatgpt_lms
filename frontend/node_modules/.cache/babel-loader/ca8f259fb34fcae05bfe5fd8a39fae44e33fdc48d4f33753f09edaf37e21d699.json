{"ast":null,"code":"'use client';\n\nimport { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useCallback } from \"react\";\nimport { classNames, noop } from \"@vkontakte/vkjs\";\nimport { useAdaptivityWithJSMediaQueries } from \"../../hooks/useAdaptivityWithJSMediaQueries.js\";\nimport { useExternRef } from \"../../hooks/useExternRef.js\";\nimport { useFocusTrap } from \"../../hooks/useFocusTrap.js\";\nimport { usePlatform } from \"../../hooks/usePlatform.js\";\nimport { useVirtualKeyboardState } from \"../../hooks/useVirtualKeyboardState.js\";\nimport { Keys, pressedKey } from \"../../lib/accessibility.js\";\nimport { useCSSTransition } from \"../../lib/animation/index.js\";\nimport { useBottomSheet } from \"../../lib/sheet/index.js\";\nimport { useScrollLock } from \"../AppRoot/ScrollContext.js\";\nimport { ModalCardBase } from \"../ModalCardBase/ModalCardBase.js\";\nimport { ModalOutlet } from \"../ModalOutlet/ModalOutlet.js\";\nimport { ModalOverlay as ModalOverlayDefault } from \"../ModalOverlay/ModalOverlay.js\";\nconst sizeByPlatformClassNames = {\n  vkcom: \"vkuiModalCard__hostMaxWidthS\",\n  ios: \"vkuiModalCard__hostMaxWidthM\",\n  android: \"vkuiModalCard__hostMaxWidthL\"\n};\nconst transitionStateClassNames = {\n  appear: \"vkuiModalCard__hostStateEnter\",\n  appearing: \"vkuiModalCard__hostStateEntering\",\n  enter: \"vkuiModalCard__hostStateEnter\",\n  entering: \"vkuiModalCard__hostStateEntering\",\n  exiting: \"vkuiModalCard__hostStateExiting\",\n  exited: \"vkuiModalCard__hostStateExited\"\n};\n/**\n * В компоненте заложена вся логика модального окна.\n *\n * @private\n */\nexport const ModalCardInternal = _param => {\n  var {\n      icon,\n      title,\n      titleComponent,\n      description,\n      descriptionComponent,\n      children,\n      actions,\n      size,\n      open,\n      style: styleProp,\n      className,\n      preventClose,\n      ModalOverlay = ModalOverlayDefault,\n      modalOverlayTestId,\n      modalDismissButtonTestId,\n      getRootRef,\n      dismissButtonMode,\n      dismissLabel,\n      noFocusToDialog,\n      restoreFocus,\n      onOpen,\n      onOpened,\n      onClose = noop,\n      onClosed,\n      disableFocusTrap\n    } = _param,\n    restProps = _object_without_properties(_param, [\"icon\", \"title\", \"titleComponent\", \"description\", \"descriptionComponent\", \"children\", \"actions\", \"size\", \"open\", \"style\", \"className\", \"preventClose\", \"ModalOverlay\", \"modalOverlayTestId\", \"modalDismissButtonTestId\", \"getRootRef\", \"dismissButtonMode\", \"dismissLabel\", \"noFocusToDialog\", \"restoreFocus\", \"onOpen\", \"onOpened\", \"onClose\", \"onClosed\", \"disableFocusTrap\"]);\n  const platform = usePlatform();\n  const [transitionState, {\n    ref,\n    onTransitionEnd\n  }] = useCSSTransition(open, {\n    enableAppear: true,\n    onEnter() {\n      onOpen === null || onOpen === void 0 ? void 0 : onOpen();\n    },\n    onEntered() {\n      onOpened === null || onOpened === void 0 ? void 0 : onOpened();\n    },\n    onExited() {\n      onClosed === null || onClosed === void 0 ? void 0 : onClosed();\n    }\n  });\n  const opened = transitionState === 'appeared' || transitionState === 'entered';\n  const hidden = transitionState === 'exited';\n  const closable = !preventClose && opened;\n  const {\n    isDesktop\n  } = useAdaptivityWithJSMediaQueries();\n  const bottomSheetEnabled = !isDesktop && !preventClose && transitionState !== 'exited';\n  const {\n    opened: keyboardOpened\n  } = useVirtualKeyboardState(bottomSheetEnabled);\n  const [{\n    setSheetEl,\n    setBackdropEl\n  }, bottomSheetEventHandlers] = useBottomSheet(bottomSheetEnabled, {\n    blocked: keyboardOpened,\n    snapPoint: 'auto',\n    sheetCSSProperty: '--vkui_internal_ModalCard--translateY',\n    backdropCSSProperty: '--vkui_internal--modal-overlay--opacity',\n    onDismiss() {\n      onClose === null || onClose === void 0 ? void 0 : onClose('swipe-down');\n    }\n  });\n  const handleRef = useExternRef(setSheetEl, ref, getRootRef);\n  const style = keyboardOpened ? _object_spread_props(_object_spread({}, styleProp), {\n    '--vkui_internal_ModalCard--safeAreaInsetBottom': '0px'\n  }) : styleProp;\n  const modalOverlay = /*#__PURE__*/_jsx(ModalOverlay, {\n    getRootRef: setBackdropEl,\n    \"data-testid\": modalOverlayTestId,\n    visible: open,\n    onClick: closable ? function handleBackdropClick(event) {\n      onClose('click-overlay', event);\n    } : undefined\n  });\n  const handleEscKeyDown = useCallback(event => {\n    if (closable && pressedKey(event) === Keys.ESCAPE) {\n      onClose('escape-key');\n    }\n  }, [closable, onClose]);\n  useScrollLock(!hidden);\n  useFocusTrap(ref, {\n    autoFocus: !noFocusToDialog,\n    disabled: !opened || hidden || disableFocusTrap,\n    restoreFocus\n  });\n  return /*#__PURE__*/_jsxs(ModalOutlet, {\n    hidden: hidden,\n    isDesktop: isDesktop,\n    onKeyDown: handleEscKeyDown,\n    children: [modalOverlay, /*#__PURE__*/_jsx(ModalCardBase, _object_spread_props(_object_spread(_object_spread_props(_object_spread({}, restProps), {\n      tabIndex: -1,\n      role: \"dialog\",\n      \"aria-modal\": \"true\",\n      getRootRef: handleRef,\n      style: style,\n      className: classNames(\"vkuiModalCard__host\", isDesktop ? \"vkuiModalCard__hostDesktop\" : \"vkuiModalCard__hostMobile\", sizeByPlatformClassNames[platform], transitionStateClassNames[transitionState], className),\n      onTransitionEnd: onTransitionEnd\n    }), bottomSheetEventHandlers), {\n      icon: icon,\n      title: title,\n      titleComponent: titleComponent,\n      description: description,\n      descriptionComponent: descriptionComponent,\n      actions: actions,\n      onClose: () => onClose('click-close-button'),\n      size: size,\n      modalDismissButtonTestId: modalDismissButtonTestId,\n      dismissButtonMode: dismissButtonMode,\n      dismissLabel: dismissLabel,\n      children: children\n    }))]\n  });\n};","map":{"version":3,"names":["useCallback","classNames","noop","useAdaptivityWithJSMediaQueries","useExternRef","useFocusTrap","usePlatform","useVirtualKeyboardState","Keys","pressedKey","useCSSTransition","useBottomSheet","useScrollLock","ModalCardBase","ModalOutlet","ModalOverlay","ModalOverlayDefault","sizeByPlatformClassNames","vkcom","ios","android","transitionStateClassNames","appear","appearing","enter","entering","exiting","exited","ModalCardInternal","_param","icon","title","titleComponent","description","descriptionComponent","children","actions","size","open","style","styleProp","className","preventClose","modalOverlayTestId","modalDismissButtonTestId","getRootRef","dismissButtonMode","dismissLabel","noFocusToDialog","restoreFocus","onOpen","onOpened","onClose","onClosed","disableFocusTrap","restProps","_object_without_properties","platform","transitionState","ref","onTransitionEnd","enableAppear","onEnter","onEntered","onExited","opened","hidden","closable","isDesktop","bottomSheetEnabled","keyboardOpened","setSheetEl","setBackdropEl","bottomSheetEventHandlers","blocked","snapPoint","sheetCSSProperty","backdropCSSProperty","onDismiss","handleRef","_object_spread_props","_object_spread","modalOverlay","_jsx","visible","onClick","handleBackdropClick","event","undefined","handleEscKeyDown","ESCAPE","autoFocus","disabled","_jsxs","onKeyDown","tabIndex","role"],"sources":["/Users/viktoriaromazanova/PycharmProjects/vk_chatgpt/frontend/node_modules/@vkontakte/vkui/src/components/ModalCard/ModalCardInternal.tsx"],"sourcesContent":["'use client';\n\nimport { type ComponentType, type KeyboardEvent, type ReactNode, useCallback } from 'react';\nimport { classNames, noop } from '@vkontakte/vkjs';\nimport { useAdaptivityWithJSMediaQueries } from '../../hooks/useAdaptivityWithJSMediaQueries';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useFocusTrap } from '../../hooks/useFocusTrap';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useVirtualKeyboardState } from '../../hooks/useVirtualKeyboardState';\nimport { Keys, pressedKey } from '../../lib/accessibility';\nimport { useCSSTransition, type UseCSSTransitionState } from '../../lib/animation';\nimport { useBottomSheet } from '../../lib/sheet';\nimport { useScrollLock } from '../AppRoot/ScrollContext';\nimport { ModalCardBase } from '../ModalCardBase/ModalCardBase';\nimport { ModalOutlet } from '../ModalOutlet/ModalOutlet';\nimport {\n  ModalOverlay as ModalOverlayDefault,\n  type ModalOverlayProps,\n} from '../ModalOverlay/ModalOverlay';\nimport type { ModalCardProps } from './types';\nimport styles from './ModalCard.module.css';\n\nconst sizeByPlatformClassNames = {\n  vkcom: styles['hostMaxWidthS'],\n  ios: styles['hostMaxWidthM'],\n  android: styles['hostMaxWidthL'],\n};\n\nconst transitionStateClassNames: Partial<Record<UseCSSTransitionState, string>> = {\n  appear: styles['hostStateEnter'],\n  appearing: styles['hostStateEntering'],\n\n  enter: styles['hostStateEnter'],\n  entering: styles['hostStateEntering'],\n\n  exiting: styles['hostStateExiting'],\n  exited: styles['hostStateExited'],\n};\n\nexport interface ModalCardInternalProps extends Omit<ModalCardProps, 'nav' | 'keepMounted'> {\n  ModalOverlay?: ComponentType<ModalOverlayProps>;\n}\n\n/**\n * В компоненте заложена вся логика модального окна.\n *\n * @private\n */\nexport const ModalCardInternal = ({\n  icon,\n  title,\n  titleComponent,\n  description,\n  descriptionComponent,\n  children,\n  actions,\n  size,\n  open,\n  style: styleProp,\n  className,\n  preventClose,\n  ModalOverlay = ModalOverlayDefault,\n  modalOverlayTestId,\n  modalDismissButtonTestId,\n  getRootRef,\n  dismissButtonMode,\n  dismissLabel,\n  noFocusToDialog,\n  restoreFocus,\n  onOpen,\n  onOpened,\n  onClose = noop,\n  onClosed,\n  disableFocusTrap,\n  ...restProps\n}: ModalCardInternalProps): ReactNode => {\n  const platform = usePlatform();\n  const [transitionState, { ref, onTransitionEnd }] = useCSSTransition<HTMLDivElement>(open, {\n    enableAppear: true,\n    onEnter() {\n      onOpen?.();\n    },\n    onEntered() {\n      onOpened?.();\n    },\n    onExited() {\n      onClosed?.();\n    },\n  });\n  const opened = transitionState === 'appeared' || transitionState === 'entered';\n  const hidden = transitionState === 'exited';\n  const closable = !preventClose && opened;\n\n  const { isDesktop } = useAdaptivityWithJSMediaQueries();\n  const bottomSheetEnabled = !isDesktop && !preventClose && transitionState !== 'exited';\n\n  const { opened: keyboardOpened } = useVirtualKeyboardState(bottomSheetEnabled);\n  const [{ setSheetEl, setBackdropEl }, bottomSheetEventHandlers] = useBottomSheet(\n    bottomSheetEnabled,\n    {\n      blocked: keyboardOpened,\n      snapPoint: 'auto',\n      sheetCSSProperty: '--vkui_internal_ModalCard--translateY',\n      backdropCSSProperty: '--vkui_internal--modal-overlay--opacity',\n      onDismiss() {\n        onClose?.('swipe-down');\n      },\n    },\n  );\n  const handleRef = useExternRef<HTMLDivElement>(setSheetEl, ref, getRootRef);\n  const style = keyboardOpened\n    ? {\n        ...styleProp,\n        '--vkui_internal_ModalCard--safeAreaInsetBottom': '0px',\n      }\n    : styleProp;\n  const modalOverlay = (\n    <ModalOverlay\n      getRootRef={setBackdropEl}\n      data-testid={modalOverlayTestId}\n      visible={open}\n      onClick={\n        closable\n          ? function handleBackdropClick(event) {\n              onClose('click-overlay', event);\n            }\n          : undefined\n      }\n    />\n  );\n  const handleEscKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLElement>) => {\n      if (closable && pressedKey(event) === Keys.ESCAPE) {\n        onClose('escape-key');\n      }\n    },\n    [closable, onClose],\n  );\n\n  useScrollLock(!hidden);\n  useFocusTrap(ref, {\n    autoFocus: !noFocusToDialog,\n    disabled: !opened || hidden || disableFocusTrap,\n    restoreFocus,\n  });\n\n  return (\n    <ModalOutlet hidden={hidden} isDesktop={isDesktop} onKeyDown={handleEscKeyDown}>\n      {modalOverlay}\n      <ModalCardBase\n        {...restProps}\n        tabIndex={-1}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        getRootRef={handleRef}\n        style={style}\n        className={classNames(\n          styles.host,\n          isDesktop ? styles.hostDesktop : styles.hostMobile,\n          sizeByPlatformClassNames[platform],\n          transitionStateClassNames[transitionState],\n          className,\n        )}\n        onTransitionEnd={onTransitionEnd}\n        {...bottomSheetEventHandlers}\n        icon={icon}\n        title={title}\n        titleComponent={titleComponent}\n        description={description}\n        descriptionComponent={descriptionComponent}\n        actions={actions}\n        onClose={() => onClose('click-close-button')}\n        size={size}\n        modalDismissButtonTestId={modalDismissButtonTestId}\n        dismissButtonMode={dismissButtonMode}\n        dismissLabel={dismissLabel}\n      >\n        {children}\n      </ModalCardBase>\n    </ModalOutlet>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}